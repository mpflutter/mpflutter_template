"use strict";var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).MPDOM=e()}}((function(){var define,module,exports;return function e(t,i,n){function o(s,a){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};t[s][0].call(u.exports,(function(e){return o(t[s][1][e]||e)}),u,u.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.BrowserApp=void 0;var n=e("./platform_channel/plugin_register"),o=e("./platform_channel/mp_method_channel"),r=e("./page"),s=e("./router"),a=function(){function e(e,t){this.rootElement=e,this.engine=t,this.router=new l(this.engine),t.app=this,this.setupPageScrollListener()}return e.prototype.setupPageScrollListener=function(){var e=this;document.addEventListener("scroll",(function(){var t;if(document.documentElement.scrollHeight>innerHeight&&window.pageYOffset+innerHeight>=document.documentElement.scrollHeight){var i=(null===(t=e.engine.app)||void 0===t?void 0:t.router).history;i[i.length-1].item.onReachBottom()}}))},e.prototype.getURLSearchParams=function(){try{for(var e={},t=new URL(window.location.href).searchParams,i=t.keys(),n=i.next();!n.done&&(e[n.value]=t.get(n.value),!(n=i.next()).done););return e}catch(e){return console.error(e),{}}},e.prototype.setupFirstPage=function(e,t){var i,n;return __awaiter(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(a){switch(a.label){case 0:return e||(this.router.isPathRewriteEnabled?e={route:new URL(window.location.href).pathname||"/",params:this.getURLSearchParams()}:(delete(o=__assign({},this.getURLSearchParams())).route,e={route:new URL(window.location.href).searchParams.get("route")||"/",params:o})),(s=new r.Page(this.rootElement,this.engine,e)).isFirst=!0,t?(this.router.history.forEach((function(e){return e.item.active=!1})),this.router.history[0]={item:s,scrollPosition:0}):this.router.history.push({item:s,scrollPosition:0}),[4,s.ready()];case 1:return a.sent(),this.router.didSetupFirst(s.viewId,null!==(i=null==e?void 0:e.route)&&void 0!==i?i:"/",null!==(n=null==e?void 0:e.params)&&void 0!==n?n:{}),[2]}}))}))},e.prototype.enablePathRewrite=function(){this.router.isPathRewriteEnabled=!0},e}();i.BrowserApp=a;var l=function(e){function t(t){var i=e.call(this,t)||this;return i.history=[],i.isPathRewriteEnabled=!1,i.doBacking=!1,window.addEventListener("popstate",(function(e){if(i.doBacking)return!0;if(window.history.state&&window.history.state.routeId){var t=window.history.state.routeId;i.history.length>1?(i.popHistory(),i.engine.sendMessage(JSON.stringify({type:"router",message:{event:"popToRoute",routeId:t}}))):i.engine.app&&i.engine.app instanceof a&&i.engine.app.setupFirstPage(void 0,!0)}})),i}return __extends(t,e),t.prototype.encodePath=function(e,t){var i=[];if(t)for(var n in t)i.push(n+"="+encodeURIComponent(t[n]));if(this.isPathRewriteEnabled)return i.length>0?e+"?"+i.join("&"):""+e;var o=e.indexOf("?")>=0?e.split("?")[0]:e,r=e.indexOf("?")>=0?e.substr(e.indexOf("?")):"";return i.length>0?"?route="+encodeURI(o)+encodeURIComponent(r)+"&"+i.join("&"):"?route="+encodeURI(o)+encodeURIComponent(r)},t.prototype.didSetupFirst=function(e,t,i){window.history.replaceState({routeId:e},"",this.encodePath(t,i))},t.prototype.didPush=function(e){var t=e.routeId;this.thePushingRouteId=t;var i=e.name;window.history.pushState({routeId:t},"",this.encodePath(i,e.params));var n=window.pageYOffset,o=new r.Page(this.engine.app.rootElement,this.engine);this.pushHistory(o,n)},t.prototype.didReplace=function(e){var t=e.routeId;this.thePushingRouteId=t;var i=e.name;window.history.replaceState({routeId:t},"",this.encodePath(i,e.params));var n=new r.Page(this.engine.app.rootElement,this.engine);this.replaceHistory(n)},t.prototype.didPop=function(){var e=this;this.doBacking=!0,window.history.back(),this.popHistory(),setTimeout((function(){e.doBacking=!1}),100)},t.prototype.pushHistory=function(e,t){this.history.forEach((function(e){return e.item.active=!1})),this.history.push({item:e,scrollPosition:t}),window.scrollTo(0,0)},t.prototype.replaceHistory=function(e){this.history.forEach((function(e){return e.item.active=!1})),this.history[this.history.length-1]={item:e,scrollPosition:0},window.scrollTo(0,0)},t.prototype.popHistory=function(){this.history.length<=1||(this.history.pop().item.active=!1,this.history[this.history.length-1].item.active=!0,window.scrollTo(0,this.history[this.history.length-1].scrollPosition))},t}(s.Router),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onMethodCall=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){if("Clipboard.setData"===e)return i=document.createElement("input"),document.body.appendChild(i),i.value=t.text,i.select(),document.execCommand("Copy"),i.remove(),[2,null];throw"Clipboard.getData"===e?"The operation of getData from clip board is not allow in browser.":"NOTIMPLEMENTED"}))}))},t}(o.MPMethodChannel);n.PluginRegister.registerChannel("flutter/platform",c)},{"./page":49,"./platform_channel/mp_method_channel":51,"./platform_channel/plugin_register":53,"./router":54}],2:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AbsorbPointer=void 0;var n=e("../component_view"),o=(e("./gesture_detector"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.didSetListener=!1,t}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.didSetListener||(this.didSetListener=!0,this.htmlElement.addEventListener("click",(function(e){e.stopPropagation()})))},t}(n.ComponentView));i.AbsorbPointer=o},{"../component_view":27,"./gesture_detector":12}],3:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ClipOval=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{borderRadius:"50%",overflow:"hidden"})},t}(n.ComponentView);i.ClipOval=r},{"../component_view":27,"../dom_utils":29}],4:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ClipRRectAncestor=i.ClipRRect=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){var i,n,s,a,l;e.prototype.setAttributes.call(this,t);var c=t.borderRadius?(0,r.cssBorderRadius)(t.borderRadius):{};c.borderRadius?(0,o.setDOMStyle)(this.htmlElement,{borderRadius:null!==(i=c.borderRadius)&&void 0!==i?i:"unset",overflow:"hidden"}):(0,o.setDOMStyle)(this.htmlElement,{borderTopLeftRadius:null!==(n=c.borderTopLeftRadius)&&void 0!==n?n:"unset",borderTopRightRadius:null!==(s=c.borderTopRightRadius)&&void 0!==s?s:"unset",borderBottomLeftRadius:null!==(a=c.borderBottomLeftRadius)&&void 0!==a?a:"unset",borderBottomRightRadius:null!==(l=c.borderBottomRightRadius)&&void 0!==l?l:"unset",overflow:"hidden"})},t}(n.ComponentView);i.ClipRRect=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){var i,n,o,s,a;e.prototype.setAttributes.call(this,t),this.target.ancestorStyle.opacity||(this.target.ancestorStyle.opacity=1);var l=t.borderRadius?(0,r.cssBorderRadius)(t.borderRadius):{};l.borderRadius?(this.target.ancestorStyle.borderRadius=null!==(i=l.borderRadius)&&void 0!==i?i:"unset",this.target.ancestorStyle.overflow="hidden"):(this.target.ancestorStyle.borderTopLeftRadius=null!==(n=l.borderTopLeftRadius)&&void 0!==n?n:"unset",this.target.ancestorStyle.borderTopRightRadius=null!==(o=l.borderTopRightRadius)&&void 0!==o?o:"unset",this.target.ancestorStyle.borderBottomLeftRadius=null!==(s=l.borderBottomLeftRadius)&&void 0!==s?s:"unset",this.target.ancestorStyle.borderBottomRightRadius=null!==(a=l.borderBottomRightRadius)&&void 0!==a?a:"unset",this.target.ancestorStyle.overflow="hidden")},t}(n.AncestorView);i.ClipRRectAncestor=a},{"../component_view":27,"../dom_utils":29,"../utils":42}],5:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CollectionViewLayout=i.CollectionView=void 0;var n=e("../../env"),o=e("../component_view"),r=e("../dom_utils"),s=e("../utils"),a=e("./sliver_persistent_header"),l=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.classname="CollectionView",n.wrapperHtmlElement=n.document.createElement("div"),n.appBarPinnedViews=[],n.appBarPersistentHeight=0,n.enabledRestoration=!1,n.lastScrollX=0,n.lastScrollY=0,n.viewWidth=0,n.viewHeight=0,n.bottomBarHeight=0,n.bottomBarWithSafeArea=!1,n.didAddScrollListener=!1,n.didAddRefreshListener=!1,n.didAddScrollToLowerListener=!1,n.htmlElement.appendChild(n.wrapperHtmlElement),n}return __extends(t,e),t.prototype.elementType=function(){var e,t,i;return(null===(e=this.initialAttributes)||void 0===e?void 0:e.restorationId)||(null===(t=this.initialAttributes)||void 0===t?void 0:t.onScroll)||(null===(i=this.initialAttributes)||void 0===i?void 0:i.onRefresh)?"wx-scroll-view":"div"},t.prototype.dispose=function(){var e;this.didAddScrollListener&&(null===(e=n.MPEnv.platformWindow(this.document))||void 0===e||e.removeEventListener("scroll",this.onWindowScrollEvent),this.htmlElement.removeEventListener("scroll",this.onScrollEvent))},t.prototype.onWindowScrollEvent=function(){var e;if((null===(e=n.MPEnv.platformWindow(this.document))||void 0===e?void 0:e.mpCurrentScrollView)===this){var t=n.MPEnv.platformWindow(this.document);t&&(t.scrollX===this.lastScrollX&&t.scrollY===this.lastScrollY||(this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.attributes.onScroll&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScroll",target:this.attributes.onScroll,scrollLeft:t.scrollX,scrollTop:t.scrollY}}))))}},t.prototype.addWindowScrollListener=function(){var e;this.didAddScrollListener||(this.didAddScrollListener=!0,null===(e=n.MPEnv.platformWindow(this.document))||void 0===e||e.addEventListener("scroll",this.onWindowScrollEvent.bind(this)))},t.prototype.onScrollEvent=function(){this.htmlElement.scrollLeft===this.lastScrollX&&this.htmlElement.scrollTop===this.lastScrollY||(this.lastScrollX=this.htmlElement.scrollLeft,this.lastScrollY=this.htmlElement.scrollTop,this.attributes.onScroll&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScroll",target:this.attributes.onScroll,isRoot:this.attributes.isRoot,scrollLeft:this.htmlElement.scrollLeft,scrollTop:this.htmlElement.scrollTop}})))},t.prototype.addScrollListener=function(){this.didAddScrollListener||(this.didAddScrollListener=!0,this.htmlElement.addEventListener("scroll",this.onScrollEvent.bind(this)))},t.prototype.onRefreshEvent=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){e.refreshEndResolver=t,e.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onRefresh",target:e.hashCode,isRoot:e.attributes.isRoot}}))}))];case 1:return t.sent(),this.htmlElement.setAttribute("refresher-triggered","false"),[2]}}))}))},t.prototype.addRefreshListener=function(){this.didAddRefreshListener||(this.didAddRefreshListener=!0,this.htmlElement.addEventListener("refresherrefresh",this.onRefreshEvent.bind(this)))},t.prototype.onScrollToLowerEvent=function(){this.attributes.isRoot&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScrollToLower",target:this.hashCode,isRoot:this.attributes.isRoot}}))},t.prototype.addScrollToLowerListener=function(){this.didAddScrollToLowerListener||(this.didAddScrollToLowerListener=!0,this.htmlElement.addEventListener("scrolltolower",this.onScrollToLowerEvent.bind(this)))},t.prototype.didMoveToWindow=function(){e.prototype.didMoveToWindow.call(this),this.enabledRestoration,this.enabledRestoration},t.prototype.setConstraints=function(t){e.prototype.setConstraints.call(this,t),this.viewWidth===t.w&&this.viewHeight===t.h||(this.viewWidth=t.w,this.viewHeight=t.h,this.reloadLayouts())},t.prototype.reloadLayouts=function(){var e,t,i,n,o,s,l,c;this.layout.prepareLayout();for(var u=-this.appBarPersistentHeight,d=this.appBarPersistentHeight,h=0;h<this.subviews.length;h++){var p=this.subviews[h],f=this.layout.layoutAttributesForItemAtIndex(h);f&&(p.collectionViewConstraints={top:f.y.toFixed(1)+"px",left:f.x.toFixed(1)+"px"},(0,r.setDOMStyle)(p.htmlElement,{position:"absolute",top:f.y.toFixed(1)+"px",left:f.x.toFixed(1)+"px",width:f.width.toFixed(1)+"px",height:f.height.toFixed(1)+"px"}),p instanceof a.SliverPersistentHeader&&p.pinned?(p.y=f.y-u,p.h=d,u+=p.y+(null!==(t=null===(e=p.constraints)||void 0===e?void 0:e.h)&&void 0!==t?t:0),d+=null!==(n=null===(i=p.constraints)||void 0===i?void 0:i.h)&&void 0!==n?n:0,p.updateLayout()):p instanceof a.SliverPersistentHeader&&p.lazying&&(p.y=f.y-u,p.h=d,u+=p.y+(null!==(s=null===(o=p.constraints)||void 0===o?void 0:o.h)&&void 0!==s?s:0),d+=null!==(c=null===(l=p.constraints)||void 0===l?void 0:l.h)&&void 0!==c?c:0,p.updateLayout()))}var m=this.layout.collectionViewContentSize();(0,r.setDOMStyle)(this.wrapperHtmlElement,{position:"absolute",top:"0px",left:"0px",width:m.width+"px",height:this.bottomBarWithSafeArea?"calc("+(m.height+("div"===this.elementType()?this.bottomBarHeight:0))+"px + env(safe-area-inset-bottom))":m.height+("div"===this.elementType()?this.bottomBarHeight:0)+"px"})},t.prototype.setAttributes=function(t){var i,o;if(e.prototype.setAttributes.call(this,t),(0,r.setDOMStyle)(this.htmlElement,{overflow:t.isRoot?"unset":"scroll"}),this.bottomBarHeight=null!==(i=t.bottomBarHeight)&&void 0!==i?i:0,this.bottomBarWithSafeArea=null!==(o=t.bottomBarWithSafeArea)&&void 0!==o&&o,t.restorationId,t.restorationId,this.htmlElement.setAttribute("scroll-x","true"),this.htmlElement.setAttribute("scroll-y","true"),t.isRoot&&"div"===this.elementType()){var s=n.MPEnv.platformWindow(this.document);s&&(s.mpCurrentScrollView=this),this.addWindowScrollListener()}else this.addScrollListener(),this.addRefreshListener(),this.addScrollToLowerListener(),this.htmlElement.setAttribute("refresher-enabled",t.onRefresh?"true":"false")},t.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this,this.wrapperHtmlElement.appendChild(e.htmlElement),e.didMoveToWindow()},t.prototype.setPinnedAppBar=function(e){var t,i,n=this,o=this.factory.create(e.appBarPinned,this.document);if(o){o.collectionViewFixed=!0;var a=null!==(i=null===(t=o.constraints)||void 0===t?void 0:t.h)&&void 0!==i?i:0,l=0,c=1===(null==o?void 0:o.subviews.length)?0:1;null==o||o.subviews.slice().forEach((function(e,t){var i,u,d,h,p,f,m,v;t===c-1&&(l+=null!==(u=null===(i=e.constraints)||void 0===i?void 0:i.h)&&void 0!==u?u:0),t===c?((0,r.setDOMStyle)(e.htmlElement,{marginTop:-(a-l)+"px",top:"0px",position:"sticky",zIndex:"9999",backgroundColor:(null!==(h=null===(d=o.attributes)||void 0===d?void 0:d.color)&&void 0!==h?h:null===(p=o.attributes)||void 0===p?void 0:p.backgroundColor)?(0,s.cssColor)(null!==(m=null===(f=o.attributes)||void 0===f?void 0:f.color)&&void 0!==m?m:null===(v=o.attributes)||void 0===v?void 0:v.backgroundColor):"unset"}),n.appBarPersistentHeight=(0,s.cssSizeFromMPElement)(e).height):(0,r.setDOMStyle)(e.htmlElement,{marginTop:-a+"px"}),n.appBarPinnedViews.push(e)})),this.appBarPinnedViews.reverse().forEach((function(e){return n.addSubviewForPinnedAppBar(e)})),(0,r.setDOMStyle)(o.htmlElement,{pointerEvents:"none",display:"none"})}},t.prototype.addSubviewForPinnedAppBar=function(e){e.superview&&e.removeFromSuperview(),e.superview=this,this.wrapperHtmlElement.firstChild?this.wrapperHtmlElement.insertBefore(e.htmlElement,this.wrapperHtmlElement.firstChild):this.wrapperHtmlElement.appendChild(e.htmlElement),e.didMoveToWindow()},t}(o.ComponentView);i.CollectionView=l;var c=function(){function e(e){this.collectionView=e}return e.prototype.prepareLayout=function(){},e.prototype.layoutAttributesForItemAtIndex=function(e){throw""},e.prototype.collectionViewContentSize=function(){throw""},e}();i.CollectionViewLayout=c},{"../../env":45,"../component_view":27,"../dom_utils":29,"../utils":42,"./sliver_persistent_header":22}],6:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColoredBox=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:t.color?(0,r.cssColor)(t.color):"unset"})},t}(n.ComponentView);i.ColoredBox=s},{"../component_view":27,"../dom_utils":29,"../utils":42}],7:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CustomPaint=i.MPDrawable=void 0;var n=e("../../env"),o=e("../component_view"),r=e("../dom_utils"),s=e("../utils"),a=function(){function e(e){this.engine=e,this.decodedDrawables={}}return e.prototype.decodeDrawable=function(t){return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:e.offscreenCanvas||(e.offscreenCanvas=n.MPEnv.platformScope.createOffscreenCanvas()),r.label=1;case 1:return r.trys.push([1,7,,8]),"networkImage"!==t.type?[3,3]:[4,this.decodeNetworkImage(t.url,t.target)];case 2:return i=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:t.target,width:i.width,height:i.height}})),[3,6];case 3:return"memoryImage"!==t.type?[3,5]:[4,this.decodeMemoryImage(t.data,t.target)];case 4:return i=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:t.target,width:i.width,height:i.height}})),[3,6];case 5:throw new Error("Unknown drawable type.");case 6:return[3,8];case 7:return o=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onError",target:t.target,error:null==o?void 0:o.toString()}})),[3,8];case 8:return[2]}}))}))},e.prototype.decodeNetworkImage=function(t,i){return __awaiter(this,void 0,void 0,(function(){var n=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){var s=e.offscreenCanvas.createImage();s.onload=function(){n.decodedDrawables[i]=s,o({width:s.width,height:s.height})},s.onerror=function(){r("")},s.src=t}))]}))}))},e.prototype.decodeMemoryImage=function(t,i){return __awaiter(this,void 0,void 0,(function(){var n=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){var s=e.offscreenCanvas.createImage();s.onload=function(){n.decodedDrawables[i]=s,o({width:s.width,height:s.height})},s.onerror=function(){r("")},s.src="data:text/plain;base64,"+t}))]}))}))},e}();i.MPDrawable=a;var l=function(e){function t(t){var i=e.call(this,t)||this;return i.document=t,i.canvasWidth=0,i.canvasHeight=0,i.htmlElement.setAttribute("type","2d"),i}return __extends(t,e),t.didReceivedCustomPaintMessage=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){switch(i.label){case 0:return"fetchImage"!==e.event?[3,3]:(t.componentFactory.cachedView[e.target],[3,1]);case 1:return[3,3];case 2:i.sent().fields({node:!0},(function(i){var n=i.node.toDataURL().split("base64,")[1];t.sendMessage(JSON.stringify({type:"custom_paint",message:{event:"onFetchImageResult",seqId:e.seqId,data:n}}))})).exec(),i.label=3;case 3:return[2]}}))}))},t.prototype.elementType=function(){return"canvas"},t.prototype.setConstraints=function(e){if(e){var t=e.x,i=e.y,n=e.w,o=e.h;"number"==typeof t&&"number"==typeof i&&"number"==typeof n&&"number"==typeof o&&((0,r.setDOMStyle)(this.htmlElement,{left:t+"px",top:i+"px",width:n+"px",height:o+"px"}),this.canvasWidth===n&&this.canvasHeight==o||(this.canvasWidth=n,this.canvasHeight=o,(0,r.setDOMAttribute)(this.htmlElement,"width",this.canvasWidth.toString()),(0,r.setDOMAttribute)(this.htmlElement,"height",this.canvasHeight.toString())))}},t.prototype.createContext=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){setTimeout((function(){return __awaiter(e,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.htmlElement.$$getNodesRef()];case 1:return e.sent().fields({node:!0,size:!0},(function(e){var i=e.node,o=i.getContext("2d"),r=n.MPEnv.platformScope.getSystemInfoSync().pixelRatio;i.width=e.width*r,i.height=e.height*r,o.scale(r,r),t(o)})).exec(),[2]}}))}))}),16)}))]}))}))},t.prototype.setAttributes=function(t){var i;return __awaiter(this,void 0,void 0,(function(){var n,o,r=this;return __generator(this,(function(s){switch(s.label){case 0:return e.prototype.setAttributes.call(this,t),null===(i=this.ctx)||void 0===i?[3,1]:(o=i,[3,3]);case 1:return[4,this.createContext()];case 2:o=s.sent(),s.label=3;case 3:return(n=o)?(this.ctx||(this.ctx=n),n.save(),t.commands.forEach((function(e){"drawRect"===e.action?r.drawRect(n,e):"drawPath"===e.action?r.drawPath(n,e):"drawDRRect"===e.action?r.drawDRRect(n,e):"clipPath"===e.action?r.drawPath(n,e):"drawColor"===e.action?r.drawColor(n,e):"drawImage"===e.action?r.drawImage(n,e):"drawImageRect"===e.action?r.drawImageRect(n,e):"restore"===e.action?n.restore():"rotate"===e.action?n.rotate(e.radians):"save"===e.action?n.save():"scale"===e.action?n.scale(e.sx,e.sy):"skew"===e.action?n.transform(1,e.sy,e.sx,1,0,0):"transform"===e.action?n.transform(e.a,e.b,e.c,e.d,e.tx,e.ty):"translate"===e.action&&n.translate(e.dx,e.dy)})),n.restore(),[2]):[2]}}))}))},t.prototype.drawRect=function(e,t){this.setPaint(e,t.paint),"PaintingStyle.fill"===t.paint.style?e.fillRect(t.x,t.y,t.width,t.height):e.strokeRect(t.x,t.y,t.width,t.height)},t.prototype.drawPath=function(e,t){this.setPaint(e,t.paint),this.drawRealPath(e,t.path),"clipPath"===t.action?e.clip():"PaintingStyle.fill"===t.paint.style?e.fill():e.stroke()},t.prototype.drawDRRect=function(e,t){var i=document.createElement("canvas");i.width=e.canvas.width,i.height=e.canvas.height;var n=i.getContext("2d");this.setPaint(n,t.paint),this.drawRealPath(n,t.outer),"PaintingStyle.fill"===t.paint.style?n.fill():n.stroke(),n.save(),n.fillStyle="white",n.globalCompositeOperation="xor",this.drawRealPath(n,t.inner),n.fill(),n.restore(),e.drawImage(i,0,0)},t.prototype.drawRealPath=function(e,t){e.beginPath(),t.commands.forEach((function(t){"moveTo"===t.action?e.moveTo(t.x,t.y):"lineTo"===t.action?e.lineTo(t.x,t.y):"quadraticBezierTo"===t.action?e.quadraticCurveTo(t.x1,t.y1,t.x2,t.y2):"cubicTo"===t.action?e.bezierCurveTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3):"arcTo"===t.action?e.ellipse(t.x,t.y,t.width/2,t.height/2,0,t.startAngle,t.startAngle+t.sweepAngle,t.sweepAngle<0):"arcToPoint"===t.action?e.arcTo(t.arcControlX,t.arcControlY,t.arcEndX,t.arcEndY,t.radiusX):"close"===t.action&&e.closePath()}))},t.prototype.drawColor=function(e,t){"BlendMode.clear"===t.blendMode?e.clearRect(0,0,e.canvas.width,e.canvas.height):(e.fillStyle=(0,s.cssColor)(t.color),e.fillRect(0,0,e.canvas.width,e.canvas.height))},t.prototype.drawImage=function(e,t){this.setPaint(e,t.paint);var i=this.engine.drawable.decodedDrawables[t.drawable];i&&e.drawImage(i,t.dx,t.dy)},t.prototype.drawImageRect=function(e,t){this.setPaint(e,t.paint);var i=this.engine.drawable.decodedDrawables[t.drawable];i&&e.drawImage(i,t.srcX,t.srcY,t.srcW,t.srcH,t.dstX,t.dstY,t.dstW,t.dstH)},t.prototype.setPaint=function(e,t){var i;t&&(e.lineWidth=t.strokeWidth,e.miterLimit=t.strokeMiterLimit,e.lineCap=t.strokeCap.replace("StrokeCap.",""),e.lineJoin=t.strokeJoin.replace("StrokeJoin.",""),"PaintingStyle.fill"===t.style?(e.fillStyle=(0,s.cssColor)(t.color),e.strokeStyle="transparent"):(e.fillStyle="transparent",e.strokeStyle=(0,s.cssColor)(t.color)),e.globalAlpha=null!==(i=t.alpha)&&void 0!==i?i:1)},t}(o.ComponentView);i.CustomPaint=l},{"../../env":45,"../component_view":27,"../dom_utils":29,"../utils":42}],8:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CustomScrollView=void 0;var n=e("../utils"),o=e("./collection_view"),r=e("./grid_list_layout"),s=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.listChildren=[],n.layout=new a(n),n}return __extends(t,e),t.prototype.setChildren=function(t){var i=this;if(t){var n=[],o={},r={};t.forEach((function(e,t){var s,a,l,c,u,d,h,p;"sliver_list"===e.name&&e.children?(o[n.length]=e.attributes,i.factory.fetchCachedChildren(e.children).forEach((function(e){n.push(e)})),r[n.length-1]=!0):"sliver_list"===(null===(a=null===(s=e.children)||void 0===s?void 0:s[0])||void 0===a?void 0:a.name)&&(null===(c=null===(l=e.children)||void 0===l?void 0:l[0])||void 0===c?void 0:c.children)?(o[n.length]=e.children[0].attributes,i.factory.fetchCachedChildren(e.children[0].children).forEach((function(e,t){n.push(e)})),r[n.length-1]=!0):"sliver_grid"===e.name&&e.children?(o[n.length]=e.attributes,i.factory.fetchCachedChildren(e.children).forEach((function(e){n.push(e)})),r[n.length-1]=!0):"sliver_grid"===(null===(d=null===(u=e.children)||void 0===u?void 0:u[0])||void 0===d?void 0:d.name)&&(null===(p=null===(h=e.children)||void 0===h?void 0:h[0])||void 0===p?void 0:p.children)?(o[n.length]=e.children[0].attributes,i.factory.fetchCachedChildren(e.children[0].children).forEach((function(e){n.push(e)})),r[n.length-1]=!0):n.push(e)})),this.listChildren=n,this.layout.items=n,this.layout.sliverGridAttributes=o,this.layout.sliverGridEndIndex=r,e.prototype.setChildren.call(this,n),this.reloadLayouts()}},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.layout.isHorizontalScroll="Axis.horizontal"===t.scrollDirection,t.appBarPinned?this.setPinnedAppBar(t):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(e){return e.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0)},t}(o.CollectionView);i.CustomScrollView=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isHorizontalScroll=!1,t.items=[],t.maxVLength=0,t.itemLayouts=[],t.sliverGridAttributes={},t.sliverGridEndIndex={},t}return __extends(t,e),t.prototype.prepareLayout=function(){var e=this,t=this.collectionView.viewWidth,i=this.collectionView.viewHeight;if(!(this.isHorizontalScroll&&i<=.01)&&(this.isHorizontalScroll||!(t<=.01))){var o,s=[],a=0,l=0;this.items.forEach((function(c,u){var d,h,p,f;if(e.sliverGridAttributes[u]){l=0,(o=new r.GridListLayout(e.collectionView)).isHorizontalScroll=e.isHorizontalScroll;for(var m=[],v=u;v<e.items.length&&(m.push(e.items[v]),!e.sliverGridEndIndex[v]);v++);o.clientWidth=e.collectionView.viewWidth,o.clientHeight=e.collectionView.viewHeight;var g=e.sliverGridAttributes[u].gridDelegate;if(g&&(o.isPlain="SliverWaterfallDelegate"!==g.classname,o.crossAxisCount=g.crossAxisCount,o.mainAxisSpacing=g.mainAxisSpacing,o.crossAxisSpacing=g.crossAxisSpacing),e.sliverGridAttributes[u].padding){var y=(0,n.cssPadding)(e.sliverGridAttributes[u].padding);o.padding.top=parseFloat(null!==(d=y.paddingTop)&&void 0!==d?d:"0.0"),o.padding.left=parseFloat(null!==(h=y.paddingLeft)&&void 0!==h?h:"0.0"),o.padding.bottom=parseFloat(null!==(p=y.paddingBottom)&&void 0!==p?p:"0.0"),o.padding.right=parseFloat(null!==(f=y.paddingRight)&&void 0!==f?f:"0.0")}o.items=m,o.prepareLayout()}if(o){if(l<o.itemLayouts.length){var b=__assign({},o.itemLayouts[l]);e.isHorizontalScroll?b.x+=a:b.y+=a,s.push(b)}else s.push({x:0,y:0,width:0,height:0});l++}if(e.sliverGridEndIndex[u]&&o)return e.isHorizontalScroll?a+=o.collectionViewContentSize().width:a+=o.collectionViewContentSize().height,e.maxVLength=a,void(o=void 0);if(!o){var w,_=(0,n.cssSizeFromMPElement)(c);e.isHorizontalScroll?(w={x:a,y:0,width:_.width,height:i},a+=_.width):(w={x:0,y:a,width:t,height:_.height},"sliver_persistent_header"===c.name&&c.attributes.lazying||(a+=_.height)),e.maxVLength=a,s.push(w)}})),this.itemLayouts=s}},t.prototype.collectionViewContentSize=function(){return this.isHorizontalScroll?{width:this.maxVLength,height:this.collectionView.viewHeight}:{width:this.collectionView.viewWidth,height:this.maxVLength}},t.prototype.layoutAttributesForItemAtIndex=function(e){return this.itemLayouts[e]},t}(o.CollectionViewLayout)},{"../utils":42,"./collection_view":5,"./grid_list_layout":13}],9:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.DecoratedBox=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t,i,n){var s,a,l,c,u,d,h,p,f,m=this;void 0===i&&(i={}),void 0===n&&(n=this.htmlElement),e.prototype.setAttributes.call(this,t);var v=null!=i?i:{};if(t.color?v.backgroundColor=(0,r.cssColor)(t.color):v.backgroundColor="transparent",t.image&&(v.backgroundImage='url("'+(t.image.src?t.image.src:t.image.assetName?m.engine.debugger?t.image.assetPkg?"http://"+m.engine.debugger.serverAddr+"/assets/packages/"+t.image.assetPkg+"/"+t.image.assetName:"http://"+m.engine.debugger.serverAddr+"/assets/"+t.image.assetName:"/"+(t.image.assetPkg?"assets/packages/"+t.image.assetPkg+"/"+t.assetName:"assets/"+t.image.assetName):void 0)+'")',"BoxFit.cover"===t.image.fit?v.backgroundSize="cover":v.backgroundSize="contain",v.backgroundRepeat="no-repeat"),(null===(s=t.decoration)||void 0===s?void 0:s.gradient)&&(v.backgroundImage?v.backgroundImage=(0,r.cssGradient)(t.decoration.gradient)+","+v.backgroundImage:v.background=(0,r.cssGradient)(t.decoration.gradient)),null===(l=null===(a=t.decoration)||void 0===a?void 0:a.boxShadow)||void 0===l?void 0:l[0]){var g=null===(u=null===(c=t.decoration)||void 0===c?void 0:c.boxShadow)||void 0===u?void 0:u[0];v.boxShadow=(null===(d=(0,r.cssOffset)(g.offset))||void 0===d?void 0:d.dx)+"px "+(null===(h=(0,r.cssOffset)(g.offset))||void 0===h?void 0:h.dy)+"px "+g.blurRadius+"px "+g.spreadRadius+"px "+(0,r.cssColor)(g.color)}if(null===(p=t.decoration)||void 0===p?void 0:p.borderRadius){var y=(0,r.cssBorderRadius)(t.decoration.borderRadius);for(var b in y)v[b]=y[b]}if(null===(f=t.decoration)||void 0===f?void 0:f.border){y=(0,r.cssBorder)(t.decoration.border);for(var b in y.boxSizing="border-box",y)v[b]=y[b]}(0,o.setDOMStyle)(n,v)},t}(n.ComponentView);i.DecoratedBox=s},{"../component_view":27,"../dom_utils":29,"../utils":42}],10:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.EditableText=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentElementType="",t.didSetListener=!1,t}return __extends(t,e),t.prototype.setAttributes=function(t){var i,n,s=this;e.prototype.setAttributes.call(this,t);var a=t.maxLines;if(a>1&&"textarea"!==this.contentElementType?(null===(i=this.contentElement)||void 0===i||i.remove(),this.contentElement=this.document.createElement("textarea"),this.didSetListener=!1,this.contentElementType="textarea",(0,o.setDOMStyle)(this.contentElement,{width:"100%",height:"100%",backgroundColor:"transparent",border:"none",resize:"none"}),this.htmlElement.appendChild(this.contentElement)):a<=1&&"input"!==this.contentElementType&&(null===(n=this.contentElement)||void 0===n||n.remove(),this.contentElement=this.document.createElement("input"),this.didSetListener=!1,this.contentElementType="input",(0,o.setDOMStyle)(this.contentElement,{width:"100%",height:"100%",backgroundColor:"transparent",border:"none"}),this.htmlElement.appendChild(this.contentElement)),this.contentElement){if(t.placeholderStyle){var l="";t.placeholderStyle.color&&(l+="color: "+(0,r.cssColor)(t.placeholderStyle.color)+";"),(0,o.setDOMAttribute)(this.contentElement,"placeholder-style",l)}if(this.contentElement.onkeyup=function(e){"Enter"!==e.key&&13!==e.keyCode||s._onSubmitted(e.target,e.target.value)},this.didSetListener||(this.didSetListener=!0,this.contentElement.addEventListener("submit",(function(e){var t,i;s._onSubmitted(e.target,null!==(i=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==i?i:e.target.value)})),this.contentElement.addEventListener("input",(function(e){var t,i;s._onChanged(e.target,null!==(i=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==i?i:e.target.value)}))),this.contentElement.onchange=function(e){var t,i;s._onChanged(e.target,null!==(i=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==i?i:e.target.value)},t.style){var c=(0,r.cssTextStyle)(t.style);delete c.userSelect,delete c.WebkitUserSelect,(0,o.setDOMStyle)(this.contentElement,__assign(__assign({},c),{textAlign:(0,r.cssTextAlign)(t.textAlign),boxSizing:"border-box"}))}(0,o.setDOMAttribute)(this.contentElement,"type",t.obscureText?"password":this._keyboardType(t.keyboardType));this._keyboardPattern(t.keyboardType);0,"string"==typeof t.value&&(0,o.setDOMAttribute)(this.contentElement,"value",t.value),t.autofocus&&(0,o.setDOMAttribute)(this.contentElement,"auto-focus",t.autofocus),t.autoCorrect&&(0,o.setDOMAttribute)(this.contentElement,"auto-correct",t.autoCorrect),t.placeholder&&(0,o.setDOMAttribute)(this.contentElement,"placeholder",t.placeholder),t.maxLength&&(0,o.setDOMAttribute)(this.contentElement,"maxlength",t.maxLength),(0,o.setDOMAttribute)(this.contentElement,"disabled",t.readOnly?"true":void 0)}},t.prototype.setChildren=function(){},t.prototype._keyboardType=function(e){return(null==e?void 0:e.indexOf("TextInputType.number"))>=0?"number":"text"},t.prototype._keyboardPattern=function(e){if((null==e?void 0:e.indexOf("TextInputType.number"))>=0){var t=e.indexOf("signed: true")>=0,i=e.indexOf("decimal: true")>=0;if(t&&i)return"[0-9+-.]*";if(t&&!i)return"[0-9+-]*";if(!t&&!i)return"[0-9]*";if(!t&&i)return"[0-9+.]*"}return""},t.prototype._onSubmitted=function(e,t){this.attributes.onSubmitted&&(this.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onSubmitted",target:this.attributes.onSubmitted,data:t}})),e.blur())},t.prototype._onChanged=function(e,t){this.attributes.onChanged&&this.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onChanged",target:this.attributes.onChanged,data:t}}))},t}(n.ComponentView);i.EditableText=s},{"../component_view":27,"../dom_utils":29,"../utils":42}],11:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ForegroundDecoratedBox=void 0;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.decorateElement=t.document.createElement("div"),t}return __extends(t,e),t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.decorateElement.remove(),this.htmlElement.appendChild(this.decorateElement)},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"},this.decorateElement)},t}(e("./decorated_box").DecoratedBox);i.ForegroundDecoratedBox=n},{"./decorated_box":9}],12:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.GestureDetector=void 0;var n=e("../../env"),o=function(e){function t(t){var i=e.call(this,t)||this;return i.document=t,i.classname="GestureDetector",i.didSetOnClicked=!1,i.didSetOnLongPressOrPan=!1,i.longPressing=!1,i.htmlElement.isGestureDetector=!0,i.setupCursor(),i}return __extends(t,e),t.prototype.setupCursor=function(){n.MPEnv.platformPC()&&(this.htmlElement.style.cursor="pointer")},t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){var i=this;e.prototype.setAttributes.call(this,t),t.onTap&&(this.didSetOnClicked||(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(e){i.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onTap",target:t.onTap}})),e.stopPropagation()})))),(t.onLongPress||t.onLongPressStart||t.onLongPressMoveUpdate||t.onLongPressEnd||t.onPanStart||t.onPanUpdate||t.onPanEnd)&&(this.didSetOnLongPressOrPan||(this.didSetOnLongPressOrPan=!0,this.setupLongPressOrPanCatcher()))},t.prototype.findGestureDetectorElement=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.isGestureDetector)return i}},t.prototype.setupLongPressOrPanCatcher=function(){var e=this;this.htmlElement.addEventListener("touchstart",(function(t){e._onTouchStart(t)}),!0),this.htmlElement.addEventListener("touchmove",(function(t){e._onTouchMove(t)}),!0),this.htmlElement.addEventListener("touchend",(function(t){e._onTouchEnd(t)}),!0),this.htmlElement.addEventListener("touchcancel",(function(t){e.longPressTimer&&(clearTimeout(e.longPressTimer),e.longPressTimer=void 0),e.longPressing=!1}),!0)},t.prototype._onTouchStart=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,n,o=this;return __generator(this,(function(r){switch(r.label){case 0:return[3,2];case 1:return i=r.sent(),[3,3];case 2:i=this.htmlElement.getBoundingClientRect(),r.label=3;case 3:return t=i,this.targetOriginInPage={x:t.left,y:t.top},n=this.attributes.onPanStart||this.attributes.onPanUpdate||this.attributes.onPanEnd,(this.attributes.onLongPress||this.attributes.onLongPressStart||this.attributes.onLongPressEnd||this.attributes.onLongPressMoveUpdate||n)&&(this.touchStartPosition={x:e.touches[0].clientX,y:e.touches[0].clientY},this.longPressTimer=setTimeout((function(){o.longPressTimer&&(o.longPressing=!0,o.attributes.onLongPress&&o.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onLongPress",target:o.attributes.onLongPress}})),(o.attributes.onLongPressStart||o.attributes.onPanStart)&&o.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:o.attributes.onPanStart?"onPanStart":"onLongPressStart",target:o.attributes.onPanStart?o.attributes.onPanStart:o.attributes.onLongPressStart,globalX:e.touches[0].clientX,globalY:e.touches[0].clientY,localX:e.touches[0].clientX-o.targetOriginInPage.x,localY:e.touches[0].clientY-o.targetOriginInPage.y}})),o.longPressTimer=void 0)}),n?0:300),n&&e.preventDefault()),[2]}}))}))},t.prototype._onTouchMove=function(e){if(this.longPressing&&(this.attributes.onLongPressMoveUpdate||this.attributes.onPanUpdate))this.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:this.attributes.onPanUpdate?"onPanUpdate":"onLongPressMoveUpdate",target:this.attributes.onPanUpdate?this.attributes.onPanUpdate:this.attributes.onLongPressMoveUpdate,globalX:e.touches[0].clientX,globalY:e.touches[0].clientY,localX:e.touches[0].clientX-this.targetOriginInPage.x,localY:e.touches[0].clientY-this.targetOriginInPage.y}})),e.preventDefault();else if(this.longPressTimer&&this.touchStartPosition){var t={x:e.touches[0].clientX,y:e.touches[0].clientY},i=Math.abs(t.x-this.touchStartPosition.x),n=Math.abs(t.y-this.touchStartPosition.y);(i>8||n>8)&&(clearTimeout(this.longPressTimer),this.longPressTimer=void 0)}},t.prototype._onTouchEnd=function(e){this.longPressing&&(this.attributes.onLongPressEnd||this.attributes.onPanEnd)?(this.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:this.attributes.onPanEnd?"onPanEnd":"onLongPressEnd",target:this.attributes.onPanEnd?this.attributes.onPanEnd:this.attributes.onLongPressEnd}})),e.preventDefault()):this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=void 0),this.longPressing=!1},t}(e("../component_view").ComponentView);i.GestureDetector=o},{"../../env":45,"../component_view":27}],13:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.GridListLayout=void 0;var n=e("../utils"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isPlain=!0,t.isHorizontalScroll=!1,t.padding={top:0,left:0,bottom:0,right:0},t.clientWidth=0,t.clientHeight=0,t.crossAxisCount=0,t.crossAxisSpacing=0,t.mainAxisSpacing=0,t.items=[],t.maxVLength=0,t.itemLayouts=[],t}return __extends(t,e),t.prototype.prepareLayout=function(){this.isPlain?this.preparePlainLayout():this.prepareWaterfallLayout()},t.prototype.preparePlainLayout=function(){var e=this,t=(this.clientWidth>0?this.clientWidth:this.collectionView.viewWidth)-this.padding.right,i=(this.clientHeight>0?this.clientHeight:this.collectionView.viewHeight)-this.padding.bottom,o=[],r=this.padding.left,s=this.padding.top,a=0;this.items.forEach((function(l,c){var u=(0,n.cssSizeFromMPElement)(l),d=u.width,h=u.height;if(e.isHorizontalScroll){var p={x:r,y:s,width:d,height:h};s+=h+e.crossAxisSpacing,a=Math.max(r+d,a),s+h-i>.1&&(s=e.padding.top,c+1<e.items.length&&(r+=d+e.mainAxisSpacing)),o.push(p)}else{p={x:r,y:s,width:d,height:h};r+=d+e.crossAxisSpacing,a=Math.max(s+h,a),r+d-t>.1&&(r=e.padding.left,c+1<e.items.length&&(s+=h+e.mainAxisSpacing)),o.push(p)}})),this.isHorizontalScroll?a+=this.padding.right:a+=this.padding.bottom,this.itemLayouts=o,this.maxVLength=a},t.prototype.prepareWaterfallLayout=function(){var e=this;if(this.crossAxisCount<=0)this.itemLayouts=[];else{var t=0,i={},o=[],r=0;this.items.forEach((function(s,a){var l=(0,n.cssSizeFromMPElement)(s),c=l.width,u=l.height,d=e.isHorizontalScroll?e.padding.left:e.padding.top,h=t,p=h+1>=e.crossAxisCount?0:h+1;if(i[h]&&i[p]){var f=i[h],m=i[p];t=e.isHorizontalScroll?m.x+m.width<f.x+f.width?p:h:m.y+m.height<f.y+f.height?p:h}else t=h;if(i[t]){f=i[t];e.isHorizontalScroll?(d=f.x+f.width,a>=e.crossAxisCount&&(d+=e.mainAxisSpacing)):(d=f.y+f.height,a>=e.crossAxisCount&&(d+=e.mainAxisSpacing))}else d=e.isHorizontalScroll?e.padding.left:e.padding.top;if(e.isHorizontalScroll){var v={x:d,y:e.padding.top+u*t+t*e.crossAxisSpacing,width:c,height:u};i[t]=v,t=(t+1)%e.crossAxisCount,r=Math.max(d+c,r),o.push(v)}else{v={x:e.padding.left+c*t+t*e.crossAxisSpacing,y:d,width:c,height:u};i[t]=v,t=(t+1)%e.crossAxisCount,r=Math.max(d+u,r),o.push(v)}})),this.isHorizontalScroll?r+=this.padding.right:r+=this.padding.bottom,this.itemLayouts=o,this.maxVLength=r}},t.prototype.collectionViewContentSize=function(){return this.isHorizontalScroll?{width:this.maxVLength,height:this.collectionView.viewHeight-this.padding.top-this.padding.bottom}:{width:this.collectionView.viewWidth-this.padding.left-this.padding.right,height:this.maxVLength}},t.prototype.layoutAttributesForItemAtIndex=function(e){return this.itemLayouts[e]},t}(e("./collection_view").CollectionViewLayout);i.GridListLayout=o},{"../utils":42,"./collection_view":5}],14:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.GridView=void 0;var n=e("../utils"),o=e("./collection_view"),r=e("./grid_list_layout"),s=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.listChildren=[],n.layout=new r.GridListLayout(n),n}return __extends(t,e),t.prototype.setChildren=function(t){var i=this;if(e.prototype.setChildren.call(this,t),t){var n=[];this.factory.fetchCachedChildren(t).forEach((function(e){n.push(e),i.factory.create(e,i.document)})),this.layout.items=n,this.listChildren=n,this.reloadLayouts()}},t.prototype.setAttributes=function(t){var i,o,r,s;e.prototype.setAttributes.call(this,t),this.layout.isHorizontalScroll="Axis.horizontal"===t.scrollDirection;var a=t.gridDelegate;if(a&&(this.layout.isPlain="SliverWaterfallDelegate"!==a.classname,this.layout.crossAxisCount=a.crossAxisCount,this.layout.mainAxisSpacing=a.mainAxisSpacing,this.layout.crossAxisSpacing=a.crossAxisSpacing),t.padding){var l=(0,n.cssPadding)(this.attributes.padding);this.layout.padding.top=parseFloat(null!==(i=l.paddingTop)&&void 0!==i?i:"0.0"),this.layout.padding.left=parseFloat(null!==(o=l.paddingLeft)&&void 0!==o?o:"0.0"),this.layout.padding.bottom=parseFloat(null!==(r=l.paddingBottom)&&void 0!==r?r:"0.0"),this.layout.padding.right=parseFloat(null!==(s=l.paddingRight)&&void 0!==s?s:"0.0")}t.appBarPinned?this.setPinnedAppBar(t):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(e){return e.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0),this.reloadLayouts()},t}(o.CollectionView);i.GridView=s},{"../utils":42,"./collection_view":5,"./grid_list_layout":13}],15:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.IgnorePointer=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{pointerEvents:"none"})},t}(n.ComponentView);i.IgnorePointer=r},{"../component_view":27,"../dom_utils":29}],16:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Image=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.elementType=function(){return"img"},t.prototype.updateLayout=function(){var t,i,n,r,s,a;(null===(t=this.attributes)||void 0===t?void 0:t.width)&&(null===(i=this.attributes)||void 0===i?void 0:i.height)||(null===(n=this.constraints)||void 0===n?void 0:n.w)&&(null===(r=this.constraints)||void 0===r?void 0:r.h)?e.prototype.updateLayout.call(this):(0,o.setDOMStyle)(this.htmlElement,{position:null!==(a=null===(s=this.additionalConstraints)||void 0===s?void 0:s.position)&&void 0!==a?a:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})},t.prototype.setAttributes=function(t){var i=this;if(e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{objectFit:function(){if(!t.fit)return"cover";switch(t.fit){case"BoxFit.fill":return"fill";default:return"contain";case"BoxFit.cover":return"cover";case"BoxFit.fitWidth":case"BoxFit.fitHeight":return"scale-down";case"BoxFit.none":return"none"}}()}),t.fit&&(0,o.setDOMAttribute)(this.htmlElement,"mode",function(){if(!t.fit)return"cover";switch(t.fit){case"BoxFit.fill":return"scaleToFill";default:return"aspectFit";case"BoxFit.cover":return"aspectFill";case"BoxFit.fitWidth":return"widthFix";case"BoxFit.fitHeight":return"heightFix"}}()),t.src)t.lazyLoad?((0,o.setDOMAttribute)(this.htmlElement,"lazyLoad","true"),(0,o.setDOMAttribute)(this.htmlElement,"src",t.src)):(0,o.setDOMAttribute)(this.htmlElement,"src",t.src);else if(t.base64)(0,o.setDOMAttribute)(this.htmlElement,"src","data:image/png;base64,"+t.base64);else if(t.assetName)if(this.engine.debugger){var n=t.assetPkg?"http://"+i.engine.debugger.serverAddr+"/assets/packages/"+t.assetPkg+"/"+t.assetName:"http://"+i.engine.debugger.serverAddr+"/assets/"+t.assetName;(0,o.setDOMAttribute)(this.htmlElement,"src",n)}else{n="/"+(n=t.assetPkg?"assets/packages/"+t.assetPkg+"/"+t.assetName:"assets/"+t.assetName),(0,o.setDOMAttribute)(this.htmlElement,"src",n)}this.updateLayout()},t}(n.ComponentView);i.Image=r},{"../component_view":27,"../dom_utils":29}],17:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ListView=void 0;var n=e("../utils"),o=e("./collection_view"),r=e("./grid_list_layout"),s=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.listChildren=[],n.layout=new r.GridListLayout(n),n}return __extends(t,e),t.prototype.setChildren=function(t){var i=this;if(e.prototype.setChildren.call(this,t),t){var n=[];this.factory.fetchCachedChildren(t).forEach((function(e){n.push(e),i.factory.create(e,i.document)})),this.layout.items=n,this.listChildren=n,this.reloadLayouts()}},t.prototype.setAttributes=function(t){var i,o,r,s;if(e.prototype.setAttributes.call(this,t),this.layout.isHorizontalScroll="Axis.horizontal"===t.scrollDirection,t.padding){var a=(0,n.cssPadding)(this.attributes.padding);this.layout.padding.top=parseFloat(null!==(i=a.paddingTop)&&void 0!==i?i:"0.0"),this.layout.padding.left=parseFloat(null!==(o=a.paddingLeft)&&void 0!==o?o:"0.0"),this.layout.padding.bottom=parseFloat(null!==(r=a.paddingBottom)&&void 0!==r?r:"0.0"),this.layout.padding.right=parseFloat(null!==(s=a.paddingRight)&&void 0!==s?s:"0.0")}t.appBarPinned?this.setPinnedAppBar(t):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(e){return e.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0),this.reloadLayouts()},t}(o.CollectionView);i.ListView=s},{"../utils":42,"./collection_view":5,"./grid_list_layout":13}],18:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Offstage=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{display:t.offstage?"none":"unset"})},t}(n.ComponentView);i.Offstage=r},{"../component_view":27,"../dom_utils":29}],19:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.OpacityAncestor=i.Opacity=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{opacity:t.opacity.toString()})},t}(n.ComponentView);i.Opacity=r;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.target.ancestorStyle.opacity||(this.target.ancestorStyle.opacity=1),this.target.ancestorStyle.opacity*=t.opacity},t}(n.AncestorView);i.OpacityAncestor=s},{"../component_view":27,"../dom_utils":29}],20:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Overlay=void 0;e("../../env");var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.didSetListener=!1,n.additionalConstraints={position:"fixed"},(0,o.setDOMStyle)(n.htmlElement,{position:"fixed",zIndex:"10000",left:"0px",top:"0px",right:"0px",bottom:"0px",touchAction:"none"}),n}return __extends(t,e),t.prototype.supportPageContainer=function(){return!1},t.prototype.elementType=function(){return this.supportPageContainer()?"wx-page-container":"div"},t.prototype.removeFromSuperview=function(){var t,i=this;if(this.supportPageContainer()){if((0,o.setDOMAttribute)(this.htmlElement,"show",!1),!this.superview)return;var n=this.superview.subviews.indexOf(this);return n>=0&&(this.superview.subviews[n].htmlElement.remove(),null===(t=this.superview)||void 0===t||t.subviews.splice(n,1)),void setTimeout((function(){i.htmlElement.remove()}),300)}e.prototype.removeFromSuperview.call(this),this.htmlElement.remove()},t.prototype.setAttributes=function(t){var i=this;e.prototype.setAttributes.call(this,t),this.supportPageContainer()&&((0,o.setDOMAttribute)(this.htmlElement,"show",!0),(0,o.setDOMAttribute)(this.htmlElement,"position","center"),(0,o.setDOMAttribute)(this.htmlElement,"duration","0"),(0,o.setDOMAttribute)(this.htmlElement,"custom-style","position:fixed;z-index:10000;left:0px;top:0px;right:0px;bottom:0px;background-color:transparent;"),(0,o.setDOMAttribute)(this.htmlElement,"overlay-style","background-color:transparent;")),t.onBackgroundTap&&!this.didSetListener&&(this.didSetListener=!0,this.htmlElement.addEventListener("click",(function(e){t.onBackgroundTap&&(!0===t.barrierDismissible&&((0,o.setDOMAttribute)(i.htmlElement,"show",!1),i.htmlElement.remove()),i.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"onBackgroundTap",target:t.onBackgroundTap}})),e.stopPropagation())})),this.supportPageContainer()&&this.htmlElement.addEventListener("afterleave",(function(){i.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"forceClose",target:i.hashCode}}))})))},t}(n.ComponentView);i.Overlay=r},{"../../env":45,"../component_view":27,"../dom_utils":29}],21:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WidgetSpan=i.TextSpan=i.RichText=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.measuring=!1,t.didSetOnClicked=!1,t.canMeasureResultCache=!1,t.textCache="",t.textCacheSize=0,t}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setConstraints=function(e){this.measuring||e&&(this.constraints=e,this.updateLayout(),(0,o.setDOMStyle)(this.htmlElement,{position:"absolute",opacity:"1"}))},t.prototype.setAttributes=function(t){var i;e.prototype.setAttributes.call(this,t),this.htmlElement.classList.add("mp_text");var n=t.maxWidth;this.maxWidth="string"==typeof n?parseFloat(n):void 0;var s=t.maxHeight;this.maxHeight="string"==typeof s?parseFloat(s):void 0,(0,o.setDOMStyle)(this.htmlElement,{overflow:"hidden",textOverflow:"ellipsis",textAlign:(0,r.cssTextAlign)(t.textAlign),display:"-webkit-box",fontSize:"11px",fontFamily:"sans-serif",lineHeight:null===(i=t.height)||void 0===i?void 0:i.toString(),overflowWrap:"anywhere",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-line",webkitBoxOrient:"vertical",webkitLineClamp:t.maxLines?t.maxLines.toString():"99999"}),this.measureId=t.measureId},t.prototype.setSingleTextSpan=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,n,s,a=this;return __generator(this,(function(l){if(t={},e[0].attributes.style)for(n in i=(0,r.cssTextStyle)(e[0].attributes.style),this.attributes.selectable&&(delete i.userSelect,delete i.WebkitUserSelect),i)t[n]=i[n];return e[0].attributes.text&&(s=e[0].attributes.text,this.htmlElement.innerText=s,t.letterSpacing||t.wordSpacing||t.height||!1!==/[^-]/g.test(s)||(this.canMeasureResultCache=!0,this.textCache=s,this.textCacheSize=parseInt(t.fontSize))),e[0].attributes.onTap_el&&e[0].attributes.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(t){a.onClick(e[0].attributes.onTap_el,e[0].attributes.onTap_span),t&&t.stopPropagation()}))),(0,o.setDOMStyle)(this.htmlElement,t),[2]}))}))},t.prototype.setChildren=function(t){var i;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return t&&1===t.length&&"text_span"===t[0].name&&(null===(i=t[0].attributes)||void 0===i?void 0:i.text)?this.setSingleTextSpan(t):e.prototype.setChildren.call(this,t),[2]}))}))},t.prototype.onClick=function(e,t){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTap",target:e,subTarget:t}}))},t}(n.ComponentView);i.RichText=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.didSetOnClicked=!1,t}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setChildren=function(t){t instanceof Array&&t.length>0&&e.prototype.setChildren.call(this,t)},t.prototype.setAttributes=function(t){var i=this;e.prototype.setAttributes.call(this,t);var n={position:"unset",display:"inline"};if(t.style){var s=(0,r.cssTextStyle)(t.style);for(var a in t.selectable&&(delete s.userSelect,delete s.WebkitUserSelect),s)n[a]=s[a]}t.text&&(this.htmlElement.innerText=t.text,(0,o.setDOMAttribute)(this.htmlElement,"innerText",t.text)),t.onTap_el&&t.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(e){i.onClick(),e&&e.stopPropagation()}))),(0,o.setDOMStyle)(this.htmlElement,n)},t.prototype.onClick=function(){this.attributes.onTap_el&&this.attributes.onTap_span&&this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTap",target:this.attributes.onTap_el,subTarget:this.attributes.onTap_span}}))},t}(n.ComponentView);i.TextSpan=a;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.subviews[0]&&(this.subviews[0].additionalConstraints={position:"relative"},(0,o.setDOMStyle)(this.subviews[0].htmlElement,{position:"relative",display:"inline-flex"}))},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{display:"contents"})},t}(n.ComponentView);i.WidgetSpan=l},{"../component_view":27,"../dom_utils":29,"../utils":42}],22:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.SliverPersistentHeader=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pinned=!0,t.lazying=!1,t.observingScroller=!1,t.lazyOffset=0,t.y=0,t.h=0,t}return __extends(t,e),t.prototype.setAttributes=function(e){this.attributes=e,this.pinned=e.pinned,this.lazying=e.lazying,this.lazyOffset=e.lazyOffset,this.updateLayout(),this.lazying&&!this.observingScroller&&(this.observeScroller(),this.updateLazyState(0))},t.prototype.observeScroller=function(){var e,t=this;this.lazying&&!this.observingScroller&&(this.observingScroller=!0,e=function(e){t.updateLazyState(t.document.window.scrollY)},this.document.window.addEventListener("scroll",e))},t.prototype.updateLazyState=function(e){this.lazying&&(0,o.setDOMStyle)(this.htmlElement,{opacity:e>this.lazyOffset?"1.0":"0.0"})},t.prototype.updateLayout=function(){var e,t,i,n,r,s;if(this.constraints){var a=this.constraints.x,l=this.y,c=this.constraints.w,u=this.constraints.h;this.ancestors.forEach((function(e){e.constraints&&(a+=e.constraints.x,l+=e.constraints.y)})),(0,o.setDOMStyle)(this.htmlElement,{position:"sticky",left:null!==(t=null===(e=this.additionalConstraints)||void 0===e?void 0:e.left)&&void 0!==t?t:a+"px",top:this.pinned?this.h+"px":"unset",marginTop:this.pinned?l+"px":"unset",width:null!==(n=null===(i=this.additionalConstraints)||void 0===i?void 0:i.width)&&void 0!==n?n:c+"px",height:null!==(s=null===(r=this.additionalConstraints)||void 0===r?void 0:r.height)&&void 0!==s?s:u+"px",zIndex:"99"})}},t}(n.ComponentView);i.SliverPersistentHeader=r},{"../component_view":27,"../dom_utils":29}],23:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Transform=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{transform:t.transform})},t}(n.ComponentView);i.Transform=r},{"../component_view":27,"../dom_utils":29}],24:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Visibility=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{display:t.visible?"contents":"none"})},t}(n.ComponentView);i.Visibility=r},{"../component_view":27,"../dom_utils":29}],25:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WebDialogs=void 0;var n=e("../../env"),o=function(){function e(){}return e.receivedWebDialogsMessage=function(e,t){this.wxMiniProgramReceivedWebDialogsMessage(e,t)},e.wxMiniProgramReceivedWebDialogsMessage=function(e,t){var i,o;if("alert"===t.params.dialogType)n.MPEnv.platformScope.showModal({content:t.params.message,showCancel:!1,confirmText:"",success:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id}}))}});else if("confirm"===t.params.dialogType)n.MPEnv.platformScope.showModal({content:t.params.message,cancelText:"",confirmText:"",success:function(i){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:1==i.confirm}}))}});else if("prompt"===t.params.dialogType)n.MPEnv.platformScope.openReplyEditor({contentPlaceholder:t.params.message,content:null!==(i=t.params.defaultValue)&&void 0!==i?i:"",sendText:"",success:function(i){swan.closeReplyEditor(),"reply"===i.status?e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:i.content}})):e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:null}}))},fail:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:null}}))}});else if("actionSheet"===t.params.dialogType)n.MPEnv.platformScope.showActionSheet({itemList:t.params.items,success:function(i){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:i.tapIndex}}))},fail:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:null}}))}});else if("showToast"===t.params.dialogType){var r={};t.params.title&&(r.title=t.params.title),t.params.icon&&(r.icon=null===(o=t.params.icon)||void 0===o?void 0:o.replace("ToastIcon.","")),t.params.duration&&(r.duration=t.params.duration),t.params.mask&&(r.mask=t.params.mask),n.MPEnv.platformScope.showToast(r)}else"hideToast"===t.params.dialogType&&n.MPEnv.platformScope.hideToast()},e.browserMiniProgramReceivedWebDialogsMessage=function(e,t){},e}();i.WebDialogs=o},{"../../env":45}],26:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ComponentFactory=void 0;var n=e("./basic/absorb_pointer"),o=e("./basic/clip_oval"),r=e("./basic/clip_r_rect"),s=e("./basic/colored_box"),a=e("./basic/decorated_box"),l=e("./basic/gesture_detector"),c=e("./basic/ignore_pointer"),u=e("./basic/offstage"),d=e("./basic/opacity"),h=e("./basic/transform"),p=e("./basic/image"),f=e("./component_view"),m=e("./mpkit/scaffold"),v=e("./basic/rich_text"),g=e("./basic/list_view"),y=e("./basic/grid_view"),b=e("./basic/custom_scroll_view"),w=e("./basic/custom_paint"),_=e("./mpkit/icon"),P=e("./mpkit/video_view"),S=e("./mpkit/web_view"),M=e("./mpkit/page_view"),x=e("./mpkit/miniprogram_view"),E=e("./basic/overlay"),C=e("./basic/visibility"),R=e("./basic/sliver_persistent_header"),O=e("./basic/editable_text"),A=e("./mpkit/platform_view"),k=e("./basic/foreground_decorated_box"),T=e("../env"),D=e("./mpkit/switch"),L=e("./mpkit/slider"),I=e("./mpkit/picker"),V=e("./mpkit/date_picker"),B=e("./mpkit/circular_progress_indicator"),F=function(){function e(e){this.engine=e,this.cachedView={},this.cachedAncestor={},this.cachedElement={},this.textMeasureResults=[],this.markedNeedsFlushTextMeasureResult=!1}return e.prototype.create=function(t,i){var n;if(t){var o=t["^"],r=t.name,s=t.hashCode;if(1==o&&"number"==typeof s)return this.cachedView[s];if(r&&s){o||(this.cachedElement[s]=t);var a=!e.disableCache&&this.cachedView[s];if(a)return i=a.document,t.ancestors&&a.setAncestors(t.ancestors),t.constraints&&a.setConstraints(t.constraints),t.attributes&&a.setAttributes(t.attributes),t.children&&a.setChildren(this.fetchCachedChildren(t.children)),a;if(i){var l=e.components[r];l||(l=f.ComponentView);var c=new l(i,t.attributes);return(null===(n=T.MPEnv.platformGlobal())||void 0===n?void 0:n.mpDEBUG)&&c.htmlElement.setAttribute("mp-component",r),c.factory=this,c.engine=this.engine,c.hashCode=s,t.ancestors&&c.setAncestors(t.ancestors),t.constraints&&c.setConstraints(t.constraints),t.attributes&&c.setAttributes(t.attributes),t.children&&(e.disableCache?c.setChildren(t.children):c.setChildren(this.fetchCachedChildren(t.children))),e.disableCache||(this.cachedView[s]=c),c}}}},e.prototype.createAncestors=function(t,i){var n=t["^"],o=t.name,r=t.hashCode;if(1==n&&"number"==typeof r)return this.cachedAncestor[r];if(o&&r){n||(this.cachedElement[r]=t);var s=this.cachedAncestor[r];if(s){if(s.target&&s.target!==i){var a=s.target.ancestors.indexOf(s);a>=0&&s.target.ancestors.splice(a,1)}return s.target=i,t.attributes&&s.setAttributes(t.attributes),t.constraints&&s.setConstraints(t.constraints),s}if(i){var l=e.ancestors[o];if(l){var c=new l(i);return t.attributes&&c.setAttributes(t.attributes),t.constraints&&c.setConstraints(t.constraints),this.cachedAncestor[r]=c,c}}}},e.prototype.fetchCachedChildren=function(e){var t=this;return e.map((function(e){var i=e["^"],n=e.hashCode;return i&&t.cachedElement[n]?t.cachedElement[n]:e}))},e.prototype.callbackTextMeasureResult=function(e,t){var i=this;this.textMeasureResults.push({measureId:e,size:t}),this.markedNeedsFlushTextMeasureResult||(this.markedNeedsFlushTextMeasureResult=!0,setTimeout((function(){i.flushTextMeasureResult(),i.markedNeedsFlushTextMeasureResult=!1}),50))},e.prototype.flushTextMeasureResult=function(){this.textMeasureResults.length>0&&(this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onMeasured",data:this.textMeasureResults}})),this.textMeasureResults=[])},e.components={absorb_pointer:n.AbsorbPointer,clip_oval:o.ClipOval,clip_r_rect:r.ClipRRect,colored_box:s.ColoredBox,custom_paint:w.CustomPaint,custom_scroll_view:b.CustomScrollView,decorated_box:a.DecoratedBox,foreground_decorated_box:k.ForegroundDecoratedBox,editable_text:O.EditableText,gesture_detector:l.GestureDetector,grid_view:y.GridView,ignore_pointer:c.IgnorePointer,image:p.Image,list_view:g.ListView,offstage:u.Offstage,opacity:d.Opacity,overlay:E.Overlay,rich_text:v.RichText,text_span:v.TextSpan,widget_span:v.WidgetSpan,sliver_persistent_header:R.SliverPersistentHeader,transform:h.Transform,visibility:C.Visibility,mp_icon:_.MPIcon,mp_scaffold:m.MPScaffold,mp_video_view:P.MPVideoView,mp_web_view:S.MPWebView,mp_page_view:M.MPPageView,mp_platform_view:A.MPPlatformView,mp_switch:D.MPSwitch,mp_slider:L.MPSlider,mp_picker:I.MPPicker,mp_date_picker:V.MPDatePicker,mp_mini_program_view:x.MPMiniProgramView,mp_circular_progress_indicator:B.MPCircularProgressIndicator},e.ancestors={opacity:d.OpacityAncestor,clip_r_rect:r.ClipRRectAncestor},e.disableCache=!1,e}();i.ComponentFactory=F},{"../env":45,"./basic/absorb_pointer":2,"./basic/clip_oval":3,"./basic/clip_r_rect":4,"./basic/colored_box":6,"./basic/custom_paint":7,"./basic/custom_scroll_view":8,"./basic/decorated_box":9,"./basic/editable_text":10,"./basic/foreground_decorated_box":11,"./basic/gesture_detector":12,"./basic/grid_view":14,"./basic/ignore_pointer":15,"./basic/image":16,"./basic/list_view":17,"./basic/offstage":18,"./basic/opacity":19,"./basic/overlay":20,"./basic/rich_text":21,"./basic/sliver_persistent_header":22,"./basic/transform":23,"./basic/visibility":24,"./component_view":27,"./mpkit/circular_progress_indicator":30,"./mpkit/date_picker":31,"./mpkit/icon":32,"./mpkit/miniprogram_view":33,"./mpkit/page_view":34,"./mpkit/picker":35,"./mpkit/platform_view":36,"./mpkit/scaffold":37,"./mpkit/slider":38,"./mpkit/switch":39,"./mpkit/video_view":40,"./mpkit/web_view":41}],27:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AncestorView=i.ComponentView=void 0;var n=e("./dom_utils"),o=function(){function e(e,t){this.document=e,this.initialAttributes=t,this.classname="",this.subviews=[],this.disposed=!1,this.ancestors=[],this.ancestorStyle={},this.htmlElement=e.createElement(this.elementType())}return e.prototype.dispose=function(){this.disposed=!0},e.prototype.elementType=function(){return"div"},e.prototype.setConstraints=function(e){e&&(this.constraints=e,this.updateLayout())},e.prototype.updateLayout=function(){var e,t,i,o,r;if(this.constraints){var s=this.constraints.x,a=this.constraints.y,l=this.constraints.w,c=this.constraints.h;this.ancestors.forEach((function(e){e.constraints&&(s+=e.constraints.x,a+=e.constraints.y)}));var u=this.additionalConstraints;this.collectionViewConstraints&&this.superview&&"CollectionView"===this.superview.classname&&(u=this.collectionViewConstraints),(0,n.setDOMStyle)(this.htmlElement,{position:null!==(e=null==u?void 0:u.position)&&void 0!==e?e:"absolute",left:null!==(t=null==u?void 0:u.left)&&void 0!==t?t:s+"px",top:null!==(i=null==u?void 0:u.top)&&void 0!==i?i:a+"px",width:null!==(o=null==u?void 0:u.width)&&void 0!==o?o:l+"px",height:null!==(r=null==u?void 0:u.height)&&void 0!==r?r:c+"px"})}},e.prototype.setAttributes=function(e){this.attributes=e},e.prototype.setChildren=function(e){var t=this;if(e instanceof Array){var i=e.map((function(e){return t.factory.create(e,t.document)})).filter((function(e){return e})),n=!1,o=-1;if(i.length!==this.subviews.length){n=!0;for(var r=0;r<i.length;r++)if(i[r]!==this.subviews[r]){o=r;break}}else{i.every((function(e,i){return e===t.subviews[i]&&e.superview===t}))||(n=!0)}if(n)if(o>0){var s=[];for(r=o;r<this.subviews.length;r++)s.push(this.subviews[r]);s.forEach((function(e){return e.removeFromSuperview()}));for(r=o;r<i.length;r++)this.addSubview(i[r])}else this.removeAllSubviews(),i.forEach((function(e){return t.addSubview(e)}))}},e.prototype.resetAncestorStyle=function(){this.ancestorStyle.opacity&&(this.ancestorStyle.opacity=1),this.ancestorStyle.borderRadius&&(this.ancestorStyle.borderRadius="unset"),this.ancestorStyle.overflow&&(this.ancestorStyle.overflow="unset"),this.ancestorStyle.borderTopLeftRadius&&(this.ancestorStyle.borderTopLeftRadius="unset"),this.ancestorStyle.borderTopRightRadius&&(this.ancestorStyle.borderTopRightRadius="unset"),this.ancestorStyle.borderBottomLeftRadius&&(this.ancestorStyle.borderBottomLeftRadius="unset"),this.ancestorStyle.borderBottomRightRadius&&(this.ancestorStyle.borderBottomRightRadius="unset")},e.prototype.setAncestors=function(e){var t=this;!(e instanceof Array)&&this.ancestors.length>0?(this.resetAncestorStyle(),this.ancestors=[],(0,n.setDOMStyle)(this.htmlElement,this.ancestorStyle)):(this.resetAncestorStyle(),this.ancestors=e.map((function(e){return t.factory.createAncestors(e,t)})).filter((function(e){return e})),(0,n.setDOMStyle)(this.htmlElement,this.ancestorStyle))},e.prototype.removeAllSubviews=function(){this.subviews.forEach((function(e){e.superview=void 0,e.htmlElement.remove()})),this.subviews=[]},e.prototype.removeFromSuperview=function(){var e;if(this.superview){var t=this.superview.subviews.indexOf(this);t>=0&&(this.superview.subviews[t].htmlElement.remove(),null===(e=this.superview)||void 0===e||e.subviews.splice(t,1)),this.htmlElement.remove()}},e.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this,this.htmlElement.appendChild(e.htmlElement),e.didMoveToWindow()},e.prototype.didMoveToWindow=function(){this.subviews.forEach((function(e){return e.didMoveToWindow()}))},e}();i.ComponentView=o;var r=function(){function e(e){this.target=e}return e.prototype.setConstraints=function(e){e&&(this.constraints=e,this.target.updateLayout())},e.prototype.setAttributes=function(e){},e}();i.AncestorView=r},{"./dom_utils":29}],28:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.wrapDartObject=void 0;i.wrapDartObject=function(e){return null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e?e:e instanceof Array?e.map((function(e){return(0,i.wrapDartObject)(e)})):(e.o&&(e=e.o),new Proxy(e,{get:function(e,t){var n,o,r,s,a,l,c,u,d,h,p,f,m=null!==(f=null!==(d=null!==(l=null!==(r=null===(o=null===(n=null==e?void 0:e.b)||void 0===n?void 0:n[t])||void 0===o?void 0:o.b)&&void 0!==r?r:null===(a=null===(s=null==e?void 0:e.c)||void 0===s?void 0:s[t])||void 0===a?void 0:a.b)&&void 0!==l?l:null===(u=null===(c=null==e?void 0:e._nums)||void 0===c?void 0:c[t])||void 0===u?void 0:u.hashMapCellValue)&&void 0!==d?d:null===(p=null===(h=null==e?void 0:e._strings)||void 0===h?void 0:h[t])||void 0===p?void 0:p.hashMapCellValue)&&void 0!==f?f:e[t];return(0,i.wrapDartObject)(m)}}))}},{}],29:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.setDOMAttribute=i.setDOMStyle=void 0;i.setDOMStyle=function(e,t){if(0!==Object.keys(t).length){for(var i in t){var n=t[i];"string"==typeof n&&n.indexOf(".0px")>0&&(t[i]=n.replace(".0px","px"))}for(var i in t)e.style[i]=t[i]}};i.setDOMAttribute=function(e,t,i){void 0===i?e.removeAttribute(t):e.setAttribute(t,i)}},{}],30:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPCircularProgressIndicator=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s="https://cdn.jsdelivr.net/gh/mpflutter-plugins/icons/spinner.svg",a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setChildren=function(){},t.prototype.setAttributes=function(t){var i;e.prototype.setAttributes.call(this,t);var n=null!==(i=t.size)&&void 0!==i?i:36;(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:(0,r.cssColor)(t.color),mask:"url("+s+") no-repeat center",webkitMask:"url("+s+") no-repeat center",WebkitMask:"url("+s+") no-repeat center",width:"65px",height:"65px",transform:"scale("+n/65+", "+n/65+")",transformOrigin:"top left"})},t}(n.ComponentView);i.MPCircularProgressIndicator=a},{"../component_view":27,"../dom_utils":29,"../utils":42}],31:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPDatePicker=void 0;var n=e("../dom_utils"),o=function(e){function t(t){var i=e.call(this,t)||this;return i}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,n.setDOMAttribute)(this.htmlElement,"header-text",t.headerText),(0,n.setDOMAttribute)(this.htmlElement,"mode","date"),(0,n.setDOMAttribute)(this.htmlElement,"start",t.start),(0,n.setDOMAttribute)(this.htmlElement,"end",t.end),(0,n.setDOMAttribute)(this.htmlElement,"value",t.defaultValue)},t.prototype.showDatePicker=function(e){var t=this;window.weui.datePicker({start:this.attributes.start,end:this.attributes.end,defaultValue:this.attributes.defaultValue.split("-").map((function(e){return parseInt(e)})),onConfirm:function(e){t.invokeMethod("callbackResult",{value:null==e?void 0:e.map((function(e){return e.value}))})},onClose:function(){e.remove()},container:e})},t}(e("../mpkit/platform_view").MPPlatformView);i.MPDatePicker=o},{"../dom_utils":29,"../mpkit/platform_view":36}],32:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPIcon=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setChildren=function(){},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:(0,r.cssColor)(t.color),mask:"url("+t.iconUrl+") no-repeat center",webkitMask:"url("+t.iconUrl+") no-repeat center",WebkitMask:"url("+t.iconUrl+") no-repeat center",width:"24px",height:"24px",transform:"scale("+t.size/24+", "+t.size/24+")",transformOrigin:"top left"})},t}(n.ComponentView);i.MPIcon=s},{"../component_view":27,"../dom_utils":29,"../utils":42}],33:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPMiniProgramView=void 0;var n=e("../../components/mpkit/platform_view"),o=e("../dom_utils"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventListened={},t}return __extends(t,e),t.prototype.elementType=function(){var e;return"wx-"+(null===(e=this.initialAttributes)||void 0===e?void 0:e.tag)},t.prototype.setAttributes=function(t){for(var i in e.prototype.setAttributes.call(this,t),t)"style"===i?(0,o.setDOMStyle)(this.htmlElement,t[i]):0===i.indexOf("on.")?this.addEventListener(i,t[i]):(0,o.setDOMAttribute)(this.htmlElement,i,t[i])},t.prototype.addEventListener=function(e,t){var i=this;this.eventListened[e]?this.eventListened[e]=t:(this.eventListened[e]=t,this.htmlElement.addEventListener(e.replace("on.",""),(function(t){var n=i.eventListened[e];if(0!==n.length){var o={};n.forEach((function(e){var i;o[e]=null===(i=t.detail)||void 0===i?void 0:i[e]})),i.invokeMethod(e,o)}else i.invokeMethod(e,t.detail)})))},t}(n.MPPlatformView);i.MPMiniProgramView=r},{"../../components/mpkit/platform_view":36,"../dom_utils":29}],34:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPPageView=void 0;var n=e("../mpkit/platform_view"),o=e("../dom_utils"),r=(function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.wrapperHtmlElement=n.document.createElement("div"),n.direction="horizontal",n.loop=!1,n.wrapperHtmlElement.className="swiper-wrapper",n.htmlElement.appendChild(n.wrapperHtmlElement),n}__extends(t,e),t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.htmlElement.className="swiper-container",this.htmlElement.id="d_"+this.hashCode,this.subviews.forEach((function(e){e.htmlElement.className="swiper-slide",e.htmlElement.style.position="relative"})),this.setupSwiperInstance()},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.direction="Axis.vertical"===t.scrollDirection?"vertical":"horizontal",this.loop=t.loop,this.wrapperHtmlElement.style.flexDirection="Axis.vertical"===t.scrollDirection?"column":"row",this.setupSwiperInstance()},t.prototype.setupSwiperInstance=function(){var e=this;setTimeout((function(){e.swiperInstance?(e.swiperInstance.changeDirection(e.direction),e.swiperInstance.update()):(e.swiperInstance=new window.Swiper("#d_"+e.hashCode,{direction:e.direction,loop:e.loop,initialSlide:e.attributes.initialPage}),e.swiperInstance.on("activeIndexChange",(function(){e.invokeMethod("onPageChanged",{index:e.swiperInstance.realIndex})})))}),16)},t.prototype.onMethodCall=function(e,t){"animateToPage"===e?this.swiperInstance.slideToLoop(t.page,"number"==typeof t.duration?t.duration:500):"jumpToPage"===e?this.swiperInstance.slideToLoop(t.page,0):"nextPage"===e?this.swiperInstance.slideNext("number"==typeof t.duration?t.duration:500):"previousPage"===e&&this.swiperInstance.slidePrev("number"==typeof t.duration?t.duration:500)},t.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this,this.wrapperHtmlElement.appendChild(e.htmlElement),e.didMoveToWindow()}}(n.MPPlatformView),function(e){function t(t,i){var n,o=e.call(this,t,i)||this;return o.document=t,o.initialAttributes=i,o.maxPage=0,o.currentPage=0,o.currentPage=null!==(n=i.initialPage)&&void 0!==n?n:0,o.htmlElement.addEventListener("change",(function(e){o.currentPage=e.detail.current,o.invokeMethod("onPageChanged",{index:e.detail.current})})),i.initialPage&&o.htmlElement.setAttribute("current",i.initialPage),o}return __extends(t,e),t.prototype.elementType=function(){return"wx-swiper"},t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.maxPage=t.length-1},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMAttribute)(this.htmlElement,"vertical","Axis.vertical"===t.scrollDirection),(0,o.setDOMAttribute)(this.htmlElement,"circular",!!t.loop)},t.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this;var t=this.document.createElement("wx-swiper-item");t.appendChild(e.htmlElement),this.htmlElement.appendChild(t),e.didMoveToWindow()},t.prototype.onMethodCall=function(e,t){var i=this,n=function(){i.htmlElement.setAttribute("duration","number"==typeof t.duration?t.duration:500),setTimeout((function(){i.htmlElement.setAttribute("current",i.currentPage),i.htmlElement.setAttribute("duration","500")}),16)};"animateToPage"===e?(this.currentPage=t.page,n()):"jumpToPage"===e?(this.currentPage=t.page,t.duration=1,n()):"nextPage"===e?(this.currentPage=this.currentPage+1>this.maxPage?0:this.currentPage+1,n()):"previousPage"===e&&(this.currentPage=this.currentPage-1<0?this.maxPage:this.currentPage-1,n())},t}(n.MPPlatformView));i.MPPageView=r},{"../dom_utils":29,"../mpkit/platform_view":36}],35:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPPicker=i.PickerItem=void 0;var n=e("../dom_utils"),o=e("../mpkit/platform_view"),r=function(e,t,i){this.label=e,this.disabled=t,this.subItems=i};i.PickerItem=r;var s=function(e){function t(t,i){var o,r=e.call(this,t,i)||this;return r.initialAttributes=i,r.multiIndex=null!==(o=null==i?void 0:i.defaultValue)&&void 0!==o?o:[0,0,0],r.htmlElement.addEventListener("change",(function(e){r.invokeMethod("callbackResult",{value:"string"==typeof e.detail.value?[parseInt(e.detail.value)]:e.detail.value})})),r.htmlElement.addEventListener("columnchange",(function(e){r.updatePickerItem(e.detail.column,e.detail.value),(0,n.setDOMAttribute)(r.htmlElement,"range",r.getPickerItem())})),r}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t)},t.prototype.getPickerItem=function(){},t.prototype.updatePickerItem=function(e,t){0},t.prototype.showPicker=function(e){},t}(o.MPPlatformView);i.MPPicker=s},{"../dom_utils":29,"../mpkit/platform_view":36}],36:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPPlatformView=void 0;var n=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.document=t,n.initialAttributes=i,n.classname="PlatformView",n.elementType().indexOf("."),n}return __extends(t,e),t.handleInvokeMethodCallback=function(e,t){this._invokeMethodCompleter[e]&&(this._invokeMethodCompleter[e](t),delete this._invokeMethodCompleter[e])},t.prototype.elementType=function(){return"div"},t.prototype.setSize=function(e){this._currentSize&&this._currentSize.width===e.width&&this._currentSize.height===e.height||(this._currentSize=e,this.engine.sendMessage(JSON.stringify({type:"platform_view",message:{event:"setSize",hashCode:this.hashCode,size:e}})))},t.prototype.createFromWebTemplate=function(){return null},t.prototype.onMethodCall=function(e,t){},t.prototype.invokeMethod=function(e,i,n){void 0===n&&(n=!1);var o=this.hashCode+"_"+Math.random();if(this.engine.sendMessage(JSON.stringify({type:"platform_view",message:{event:"methodCall",hashCode:this.hashCode,method:e,params:i,seqId:o,requireResult:n}})),n)return new Promise((function(e){t._invokeMethodCompleter[o]=e}))},t._invokeMethodCompleter={},t}(e("../component_view").ComponentView);i.MPPlatformView=n},{"../component_view":27}],37:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPScaffold=void 0;var n=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t}return __extends(t,e),t.prototype.setAppBar=function(e){var t;this.appBar===e&&!0!==(null===(t=e)||void 0===t?void 0:t.collectionViewFixed)||(this.removeAllSubviews(),this.appBar=e,e&&(e.collectionViewFixed=!1,(0,o.setDOMStyle)(e.htmlElement,{pointerEvents:"unset",display:"unset"}),e.subviews.forEach((function(e){(0,o.setDOMStyle)(e.htmlElement,{position:"absolute",marginTop:"0px"})}))),e&&this.engine.pageMode&&(e.additionalConstraints={position:"fixed"},(0,o.setDOMStyle)(e.htmlElement,{position:"fixed",zIndex:"9999"})),this.readdSubviews())},t.prototype.setBody=function(e){this.body!==e&&(this.removeAllSubviews(),this.body=e,this.readdSubviews())},t.prototype.setBottomBar=function(e,t,i){this.bottomBar!==e&&(this.removeAllSubviews(),this.bottomBar=e,e&&this.engine.pageMode&&(e.additionalConstraints={position:"fixed",top:"unset"},(0,o.setDOMStyle)(e.htmlElement,{position:"fixed",top:"unset",bottom:"0px",zIndex:"9999",paddingBottom:!0===t?"env(safe-area-inset-bottom)":"",backgroundColor:i?(0,r.cssColor)(i):void 0})),this.readdSubviews())},t.prototype.setFloatingBody=function(e){this.floatingBody!==e&&(this.removeAllSubviews(),this.floatingBody=e,e&&this.engine.pageMode&&(e.additionalConstraints={position:"fixed",zIndex:"9999"},(0,o.setDOMStyle)(e.htmlElement,{position:"fixed",zIndex:"9999"})),this.readdSubviews())},t.prototype.readdSubviews=function(){this.body&&this.addSubview(this.body),this.appBar&&this.addSubview(this.appBar),this.bottomBar&&this.addSubview(this.bottomBar),this.floatingBody&&this.addSubview(this.floatingBody)},t.prototype.setAttributes=function(t){var i,n,s,a,l;e.prototype.setAttributes.call(this,t),this.setAppBar(t.appBar?this.factory.create(t.appBar,this.document):void 0),this.setBody(t.body?this.factory.create(t.body,this.document):void 0),this.setBottomBar(t.bottomBar?this.factory.create(t.bottomBar,this.document):void 0,t.bottomBarWithSafeArea,t.bottomBarSafeAreaColor),this.setFloatingBody(t.floatingBody?this.factory.create(t.floatingBody,this.document):void 0),t.name?null===(i=this.delegate)||void 0===i||i.setPageTitle(t.name):null===(n=this.delegate)||void 0===n||n.setPageTitle(""),this.delegate?t.backgroundColor?null===(s=this.delegate)||void 0===s||s.setPageBackgroundColor((0,r.cssColorHex)(t.backgroundColor)):null===(a=this.delegate)||void 0===a||a.setPageBackgroundColor("transparent"):(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:t.backgroundColor?(0,r.cssColor)(t.backgroundColor):"unset"}),t.appBarColor&&(null===(l=this.delegate)||void 0===l||l.setAppBarColor((0,r.cssColorHex)(t.appBarColor),t.appBarTintColor?(0,r.cssColorHex)(t.appBarTintColor):"#000000"))},t.prototype.setDelegate=function(e){this.delegate=e},t.prototype.onRefresh=function(){var e=this;return new Promise((function(t){e.refreshEndResolver=t,e.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onRefresh",target:e.hashCode}}))}))},t.prototype.onWechatMiniProgramShareAppMessage=function(){var e=this;return new Promise((function(t){e.onWechatMiniProgramShareAppMessageResolver=t,e.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onWechatMiniProgramShareAppMessage",target:e.hashCode}}))}))},t.prototype.onReachBottom=function(){this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onReachBottom",target:this.hashCode}}))},t.prototype.onPageScroll=function(e){this.attributes.onPageScroll&&this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onPageScroll",target:this.hashCode,scrollTop:e}}))},t.prototype.setChildren=function(){},t}(n.ComponentView);i.MPScaffold=s},{"../component_view":27,"../dom_utils":29,"../utils":42}],38:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPSlider=void 0;e("../dom_utils");var n=function(e){function t(t){var i=e.call(this,t)||this;return i.firstSetup=!0,i.htmlElement.addEventListener("change",(function(e){i.invokeMethod("onValueChanged",{value:e.detail.value})})),i}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t)},t.prototype.resetSliderValue=function(e){},t.prototype.onMethodCall=function(e,t){if("setValue"===e)null==t||t.value},t}(e("../mpkit/platform_view").MPPlatformView);i.MPSlider=n},{"../dom_utils":29,"../mpkit/platform_view":36}],39:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPSwitch=void 0;e("../dom_utils");var n=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initialAttributes=i,n.firstSetted=!1,n}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t)},t.prototype.onMethodCall=function(e,t){},t}(e("../mpkit/platform_view").MPPlatformView);i.MPSwitch=n},{"../dom_utils":29,"../mpkit/platform_view":36}],40:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPVideoView=void 0;var n=e("../dom_utils"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.elementType=function(){return"video"},t.prototype.onMethodCall=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return[3,1];case 1:return[3,4];case 2:i.videoContext=n.sent(),n.label=3;case 3:this.videoContext&&this.onMiniProgramMethodCall(e,t),n.label=4;case 4:return[2]}}))}))},t.prototype.onBrowserMethodCall=function(e,t){},t.prototype.onMiniProgramMethodCall=function(e,t){},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,n.setDOMAttribute)(this.htmlElement,"src",t.url),t.controls&&(0,n.setDOMAttribute)(this.htmlElement,"controls",t.controls),t.autoplay&&(0,n.setDOMAttribute)(this.htmlElement,"autoplay",t.autoplay),t.loop&&(0,n.setDOMAttribute)(this.htmlElement,"loop",t.loop),t.muted&&(0,n.setDOMAttribute)(this.htmlElement,"muted",t.muted),t.poster&&(0,n.setDOMAttribute)(this.htmlElement,"poster",t.poster)},t.prototype.setChildren=function(){},t}(e("./platform_view").MPPlatformView);i.MPVideoView=o},{"../dom_utils":29,"./platform_view":36}],41:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPWebView=void 0;var n=e("../dom_utils"),o=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.document=t,n.initialAttributes=i,n.htmlElement.addEventListener("message",(function(e){var t;(null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.data)instanceof Array&&n.invokeMethod("mini_program_message",{data:e.detail.data})})),n}return __extends(t,e),t.prototype.elementType=function(){return"wx-web-view"},t.prototype.onMethodCall=function(e,t){"reload"===e?((0,n.setDOMAttribute)(this.htmlElement,"src",""),(0,n.setDOMAttribute)(this.htmlElement,"src",this.attributes.url)):"loadUrl"===e&&(null==t?void 0:t.url)&&((0,n.setDOMAttribute)(this.htmlElement,"src",""),(0,n.setDOMAttribute)(this.htmlElement,"src",t.url))},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,n.setDOMAttribute)(this.htmlElement,"src",t.url),(0,n.setDOMStyle)(this.htmlElement,{border:"none"})},t.prototype.setChildren=function(){},t}(e("./platform_view").MPPlatformView);i.MPWebView=o},{"../dom_utils":29,"./platform_view":36}],42:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.cssSizeFromMPElement=i.cssPadding=i.cssTextStyle=i.cssTextAlign=i.cssBorder=i.cssOffset=i.cssGradient=i.cssBorderRadius=i.cssColorHex=i.cssColor=void 0;i.cssColor=function(e){var t=parseInt(e),i=(t>>16&255).toString(16);i.length<2&&(i="0"+i);var n=(t>>8&255).toString(16);n.length<2&&(n="0"+n);var o=(t>>0&255).toString(16);o.length<2&&(o="0"+o);var r=(t>>24&255).toString(16);return"ff"===r?"#"+i+n+o:(r.length<2&&(r="0"+r),"rgba("+(t>>16&255)+","+(t>>8&255)+","+(t>>0&255)+","+(t>>24&255)/255+")")};i.cssColorHex=function(e){var t=parseInt(e),i=(t>>16&255).toString(16);i.length<2&&(i="0"+i);var n=(t>>8&255).toString(16);n.length<2&&(n="0"+n);var o=(t>>0&255).toString(16);return o.length<2&&(o="0"+o),"#"+i+n+o};i.cssBorderRadius=function(e){var t,i,n,o,r,s,a,l,c;return 0===e.indexOf("BorderRadius.circular(")?{borderRadius:(c=e.replace("BorderRadius.circular(","").replace(")",""))+"px"}:0===e.indexOf("BorderRadius.all(")?{borderRadius:(c=e.replace("BorderRadius.all(","").replace(")",""))+"px"}:0===e.indexOf("BorderRadius.only(")?{borderTopLeftRadius:(null!==(i=null===(t=(c=e.replace("BorderRadius.only(","").replace(/\)/gi,"").replace(/Radius.circular\(/gi,"")).match(/topLeft: ([0-9|.]+)/))||void 0===t?void 0:t[1])&&void 0!==i?i:0)+"px",borderTopRightRadius:(null!==(o=null===(n=c.match(/topRight: ([0-9|.]+)/))||void 0===n?void 0:n[1])&&void 0!==o?o:0)+"px",borderBottomLeftRadius:(null!==(s=null===(r=c.match(/bottomLeft: ([0-9|.]+)/))||void 0===r?void 0:r[1])&&void 0!==s?s:0)+"px",borderBottomRightRadius:(null!==(l=null===(a=c.match(/bottomRight: ([0-9|.]+)/))||void 0===a?void 0:a[1])&&void 0!==l?l:0)+"px"}:{}};i.cssGradient=function(e){if(!e)return"";if("LinearGradient"===e.classname){return"linear-gradient("+function(){switch(e.end){case"centerRight":return"to right";case"centerLeft":return"to left";case"topRight":return"to top right";case"bottomRight":return"to bottom right";case"topLeft":return"to top left";case"bottomLeft":return"to bottom left";case"topCenter":return"to top";case"bottomCenter":return"to bottom"}}()+", "+(e.stops&&e.stops.length?e.colors.map((function(t,n){return void 0!==e.stops[n]?(0,i.cssColor)(t)+" "+(100*e.stops[n]).toFixed(0)+"%":(0,i.cssColor)(t)})):e.colors.map((function(e){return(0,i.cssColor)(e)}))).join(", ")+")"}return""};i.cssOffset=function(e){if(0===e.indexOf("Offset(")){var t=e.replace("Offset(","").replace(")","").split(",").map((function(e){return e.trim()}));return{dx:t[0],dy:t[1]}}};i.cssBorder=function(e){var t={};return"BorderStyle.none"!==e.topStyle&&(t.borderTopWidth=0===e.topWidth?(1/window.devicePixelRatio).toFixed(2)+"px":e.topWidth+"px",t.borderTopColor=(0,i.cssColor)(e.topColor),t.borderTopStyle="solid"),"BorderStyle.none"!==e.leftStyle&&(t.borderLeftWidth=0===e.leftWidth?(1/window.devicePixelRatio).toFixed(2)+"px":e.leftWidth+"px",t.borderLeftColor=(0,i.cssColor)(e.leftColor),t.borderLeftStyle="solid"),"BorderStyle.none"!==e.bottomStyle&&(t.borderBottomWidth=0===e.bottomWidth?(1/window.devicePixelRatio).toFixed(2)+"px":e.bottomWidth+"px",t.borderBottomColor=(0,i.cssColor)(e.bottomColor),t.borderBottomStyle="solid"),"BorderStyle.none"!==e.rightStyle&&(t.borderRightWidth=0===e.rightWidth?(1/window.devicePixelRatio).toFixed(2)+"px":e.rightWidth+"px",t.borderRightColor=(0,i.cssColor)(e.rightColor),t.borderRightStyle="solid"),t};i.cssTextAlign=function(e){var t=null==e?void 0:e.replace("TextAlign.","");return"start"===t?"left":"end"===t?"right":t},i.cssTextStyle=function(e){var t,n={userSelect:"none",WebkitUserSelect:"none"};return null!=e&&(e.fontFamily&&(n.fontFamily=e.fontFamily),null!=e.fontSize&&(n.fontSize=(null!==(t=e.fontSize)&&void 0!==t?t:14).toString()+"px"),null!=e.color&&(n.color=(0,i.cssColor)(e.color)),e.fontWeight&&(n.fontWeight=function(e){if(e.fontWeight)return e.fontWeight.replace("FontWeight.w","")}(e)),e.fontStyle&&(n.fontStyle=function(e){if("FontStyle.italic"===e.fontStyle)return"italic"}(e)),e.letterSpacing&&(n.letterSpacing=e.letterSpacing),e.wordSpacing&&(n.wordSpacing=e.wordSpacing),e.textBaseline&&(n.alignmentBaseline=function(e){return"TextBaseline.alphabetic"===e.textBaseline?"alphabetic":"TextBaseline.ideographic"===e.textBaseline?"ideographic":void 0}(e)),e.height&&(n.lineHeight=e.height),null!=e.backgroundColor&&(n.backgroundColor=(0,i.cssColor)(e.backgroundColor)),e.decoration&&("TextDecoration.lineThrough"===e.decoration?n.textDecoration="line-through":"TextDecoration.underline"===e.decoration&&(n.textDecoration="underline"))),n};i.cssPadding=function(e){if(!e)return{};if(0===e.indexOf("EdgeInsets.zero"))return{};if(0===e.indexOf("EdgeInsets.all("))return{paddingLeft:(t=e.replace("EdgeInsets.all(","").replace(")",""))+"px",paddingTop:t+"px",paddingRight:t+"px",paddingBottom:t+"px"};if(0===e.indexOf("EdgeInsets(")){var t,i=(t=e.replace("EdgeInsets(","").replace(")","")).split(",").map((function(e){return e.trim()}));return{paddingLeft:i[0]+"px",paddingTop:i[1]+"px",paddingRight:i[2]+"px",paddingBottom:i[3]+"px"}}return{}};i.cssSizeFromMPElement=function(e){if(!e)return{width:0,height:0};var t=0,n=0;if(e.constraints&&"number"==typeof e.constraints.w&&"number"==typeof e.constraints.h&&e.constraints.w>0&&e.constraints.h>0)t=e.constraints.w,n=e.constraints.h;else if(e.children instanceof Array&&1===e.children.length)return(0,i.cssSizeFromMPElement)(e.children[0]);return{width:t,height:n}}},{}],43:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.createDebugger=void 0;var n=e("../env");i.createDebugger=function(e,t){return new r(e,t)};var o=function(){switch(n.MPEnv.platformType){case n.PlatformType.browser:return"browser";case n.PlatformType.wxMiniProgram:return"wechatMiniProgram";default:return"unknown"}},r=function(){function e(e,t){this.serverAddr=e,this.engine=t,this.messageQueue=[],this.connected=!1}return e.prototype.start=function(){var e=this;this.socket=n.MPEnv.platformScope.connectSocket({url:"ws://"+this.serverAddr+"/ws?clientType="+o()}),this.socket.onOpen((function(){e.connected=!0,e.socketDidConnect()})),this.socket.onMessage((function(t){"string"==typeof t.data&&e.socketDidReceiveMessage(t.data)})),this.socket.onClose((function(){e.connected&&(e.engine.componentFactory.cachedElement={},e.engine.componentFactory.cachedView={},n.MPEnv.platformScope.reLaunch({url:function(){try{return"/"+n.MPEnv.platformScope.getLaunchOptionsSync().path+"?"+e.encodePathParams(n.MPEnv.platformScope.getLaunchOptionsSync().query)}catch(e){return"/pages/index/index"}}()})),e.connected=!1,e.socketDidDisconnect()}))},e.prototype.encodePathParams=function(e){var t=[];if(e)for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return t.join("&")},e.prototype.socketDidConnect=function(){var e=this;this.messageQueue.forEach((function(t){var i;null===(i=e.socket)||void 0===i||i.send({data:t})})),this.messageQueue=[]},e.prototype.socketDidDisconnect=function(){var e=this;setTimeout((function(){e.start()}),1e3)},e.prototype.socketDidReceiveMessage=function(e){this.engine.didReceivedMessage(e)},e.prototype.sendMessage=function(e){this.socket&&this.connected?this.socket.send({data:e}):this.messageQueue.push(e)},e}();!function(){function e(e,t){this.serverAddr=e,this.engine=t,this.messageQueue=[],this.connected=!1,this.needReload=!1}e.prototype.start=function(){var e=this,t="ws";"https:"===new URL(location.href).protocol&&(t="wss"),this.socket=new WebSocket(t+"://"+this.serverAddr+"/ws?clientType="+o()),this.socket.onopen=function(){e.needReload?location.href="?":(e.socketDidConnect(),e.connected=!0)},this.socket.onmessage=function(t){"string"==typeof t.data&&e.socketDidReceiveMessage(t.data)},this.socket.onclose=function(){e.needReload=!0,e.socketDidDisconnect()}},e.prototype.socketDidConnect=function(){var e=this;this.messageQueue.forEach((function(t){var i;null===(i=e.socket)||void 0===i||i.send(t)})),this.messageQueue=[]},e.prototype.socketDidDisconnect=function(){var e=this;setTimeout((function(){e.start()}),1e3)},e.prototype.socketDidReceiveMessage=function(e){this.engine.didReceivedMessage(e)},e.prototype.sendMessage=function(e){this.socket&&1==this.socket.readyState?this.socket.send(e):this.messageQueue.push(e)}}()},{"../env":45}],44:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Engine=void 0;var custom_paint_1=require("./components/basic/custom_paint"),web_dialogs_1=require("./components/basic/web_dialogs"),component_factory_1=require("./components/component_factory"),platform_view_1=require("./components/mpkit/platform_view"),debugger_1=require("./debugger/debugger"),env_1=require("./env"),platform_channel_io_1=require("./platform_channel/platform_channel_io"),mpjs_1=require("./mpjs/mpjs"),text_measurer_1=require("./text_measurer"),window_info_1=require("./window_info"),dart_object_1=require("./components/dart_object"),Engine=function(){function Engine(){this.started=!1,this.messageQueue=[],this.managedViews={},this.unmanagedViewFrameData={},this.mpJS=new mpjs_1.MPJS(this),this.windowInfo=new window_info_1.WindowInfo(this),this.pageMode=!1,this.componentFactory=new component_factory_1.ComponentFactory(this),this.drawable=new custom_paint_1.MPDrawable(this),this.platformChannelIO=new platform_channel_io_1.PlatformChannelIO(this),this.installWeChatComponentContextGetter()}return Engine.prototype.installWeChatComponentContextGetter=function(){},Engine.codeBlockWithCodePath=function(codePath){return new Promise((function(res,rej){var httpRequest=new XMLHttpRequest;httpRequest.onload=function(){res((function(){eval(httpRequest.response)}))},httpRequest.onerror=function(e){rej(e)},httpRequest.open("GET",codePath),httpRequest.send()}))},Engine.codeBlockWithFile=function(e){return function(){require(e).main()}},Engine.registerPlatformView=function(e,t){component_factory_1.ComponentFactory.components[e]=t},Engine.prototype.initWithDebuggerServerAddr=function(e){this.debugger=(0,debugger_1.createDebugger)(e,this)},Engine.prototype.initWithCodeBlock=function(e){this.codeBlock=e},Engine.prototype.start=function(){var e=this;this.started||(this.codeBlock||this.debugger)&&(this.windowInfo.updateWindowInfo(),this.listenViewport(),env_1.MPEnv.platformGlobal(),env_1.MPEnv.platformGlobal().JSON=JSON,env_1.MPEnv.platformGlobal().setTimeout=setTimeout,env_1.MPEnv.platformGlobal().setInterval=setInterval,env_1.MPEnv.platformGlobal().clearTimeout=function(e){clearTimeout(e)},env_1.MPEnv.platformGlobal().clearInterval=function(e){clearInterval(e)},env_1.MPEnv.platformGlobal().engineScope=this.mpJS.engineScope,env_1.MPEnv.platformGlobal().Object=Object,"undefined"!=typeof wx&&(env_1.MPEnv.platformGlobal().wx=wx,env_1.MPEnv.platformGlobal().uni=wx),"undefined"!=typeof swan&&(env_1.MPEnv.platformGlobal().swan=swan,env_1.MPEnv.platformGlobal().uni=swan),this.debugger&&this.debugger.start(),this.codeBlock&&(this.mpJS.engineScope.onMessage=function(t){e.didReceivedMessage(t)},this.mpJS.engineScope.onMapMessage=function(t){e.didReceivedMessage(t,!0)},e.codeBlock(),this.flushQueueMessage()),this.started=!0)},Engine.prototype.sendMessage=function(e){var t;(null===(t=env_1.MPEnv.platformGlobal())||void 0===t?void 0:t.mpDEBUG)&&console.log((new Date).getTime(),"out",JSON.parse(e)),this.debugger?this.debugger.sendMessage(e):this.mpJS.engineScope.postMessage?this.mpJS.engineScope.postMessage(e):this.messageQueue.push(e)},Engine.prototype.flushQueueMessage=function(){var e=this;this.debugger||this.mpJS.engineScope.postMessage&&this.messageQueue.forEach((function(t){e.mpJS.engineScope.postMessage(t)}))},Engine.prototype.didReceivedMessage=function(e,t){var i,n,o,r,s;void 0===t&&(t=!1);var a=t?(0,dart_object_1.wrapDartObject)(e):JSON.parse(e);a&&((null===(i=env_1.MPEnv.platformGlobal())||void 0===i?void 0:i.mpDEBUG)&&console.log((new Date).getTime(),"in",a),"frame_data"===a.type?this.didReceivedFrameData(a.message):"diff_data"===a.type?this.didReceivedDiffData(a.message):"element_gc"===a.type?a.message instanceof Array&&this.didReceivedElementGC(a.message):"decode_drawable"===a.type?this.drawable.decodeDrawable(a.message):"custom_paint"===a.type?custom_paint_1.CustomPaint.didReceivedCustomPaintMessage(a.message,this):"route"===a.type?null===(r=null!==(o=null===(n=this.app)||void 0===n?void 0:n.router)&&void 0!==o?o:this.router)||void 0===r||r.didReceivedRouteData(a.message):"mpjs"===a.type?this.didReceivedMPJS(a):"action:web_dialogs"===a.type?web_dialogs_1.WebDialogs.receivedWebDialogsMessage(this,a.message):"scaffold"===a.type?this.didReceivedScaffold(a.message):"scroll_view"===a.type?this.didReceivedScrollView(a.message):"rich_text"===a.type&&"doMeasure"===(null===(s=a.message)||void 0===s?void 0:s.event)?text_measurer_1.TextMeasurer.didReceivedDoMeasureData(this,a.message):"platform_view"===a.type?this.didReceivedPlatformView(a.message):"platform_channel"===a.type&&this.platformChannelIO.didReceivedPlatformChannel(a.message))},Engine.prototype.didReceivedFrameData=function(e){var t;if(e){var i=e.routeId;if(void 0===this.managedViews[i])return this.unmanagedViewFrameData[i]||(this.unmanagedViewFrameData[i]=[]),void this.unmanagedViewFrameData[i].push(e);"number"==typeof i&&(null===(t=this.managedViews[i])||void 0===t||t.didReceivedFrameData(e))}},Engine.prototype.didReceivedDiffData=function(e){var t=this;e&&e.diffs.forEach((function(e){t.componentFactory.create(e,void 0),t.componentFactory.createAncestors(e,void 0)}))},Engine.prototype.didReceivedElementGC=function(e){var t=this;e.forEach((function(e){var i;null===(i=t.componentFactory.cachedView[e])||void 0===i||i.dispose(),delete t.componentFactory.cachedElement[e],delete t.componentFactory.cachedView[e]}))},Engine.prototype.didReceivedScaffold=function(e){var t,i;if("onRefreshEnd"===e.event)(n=this.componentFactory.cachedView[e.target])&&(null===(t=n.refreshEndResolver)||void 0===t||t.call(n,void 0),n.refreshEndResolver=void 0);else if("onWechatMiniProgramShareAppMessageResolve"===e.event){var n;(n=this.componentFactory.cachedView[e.target])&&(null===(i=n.onWechatMiniProgramShareAppMessageResolver)||void 0===i||i.call(n,e.params),n.onWechatMiniProgramShareAppMessageResolver=void 0)}},Engine.prototype.didReceivedScrollView=function(e){var t;if("onRefreshEnd"===e.event){var i=this.componentFactory.cachedView[e.target];i&&(null===(t=i.refreshEndResolver)||void 0===t||t.call(i,void 0),i.refreshEndResolver=void 0)}},Engine.prototype.didReceivedMPJS=function(e){var t=this;this.mpJS.handleMessage(e.message,(function(i){t.sendMessage(JSON.stringify({type:"mpjs",message:{requestId:e.message.requestId,result:i}}))}),(function(e,i){t.sendMessage(JSON.stringify({type:"mpjs",message:{funcId:e,arguments:i}}))}))},Engine.prototype.didReceivedPlatformView=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,n;return __generator(this,(function(o){switch(o.label){case 0:return"methodCall"!==e.event?[3,3]:(t=this.componentFactory.cachedView[e.hashCode])?[4,t.onMethodCall(e.method,e.params)]:[3,2];case 1:i=o.sent(),e.requireResult&&this.sendMessage(JSON.stringify({type:"platform_view",message:{event:"methodCallCallback",seqId:e.seqId,result:i}})),o.label=2;case 2:return[3,4];case 3:"methodCallCallback"===e.event&&"string"==typeof(n=e.seqId)&&platform_view_1.MPPlatformView.handleInvokeMethodCallback(n,e.result),o.label=4;case 4:return[2]}}))}))},Engine.prototype.listenViewport=function(){},Engine.prototype.sendViewportChangeEvent=function(){var e=this;this.sendViewportHandler&&clearTimeout(this.sendViewportHandler),this.sendViewportHandler=setTimeout((function(){var t,i;e.windowInfo.updateWindowInfo(),null===(i=null===(t=e.app)||void 0===t?void 0:t.router)||void 0===i||i.history.forEach((function(e){e.item.viewportChanged()})),e.sendViewportHandler=void 0}),32)},Engine}();exports.Engine=Engine},{"./components/basic/custom_paint":7,"./components/basic/web_dialogs":25,"./components/component_factory":26,"./components/dart_object":28,"./components/mpkit/platform_view":36,"./debugger/debugger":43,"./env":45,"./mpjs/mpjs":48,"./platform_channel/platform_channel_io":52,"./text_measurer":55,"./window_info":56}],45:[function(e,t,i){(function(e){(function(){var t;Object.defineProperty(i,"__esModule",{value:!0}),i.MPEnv=i.PlatformType=void 0,function(e){e[e.unknown=0]="unknown",e[e.browser=1]="browser",e[e.wxMiniProgram=2]="wxMiniProgram",e[e.swanMiniProgram=3]="swanMiniProgram"}(t=i.PlatformType||(i.PlatformType={}));var n={};i.MPEnv={platformType:"undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync?t.wxMiniProgram:"undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync?t.swanMiniProgram:t.browser,platformScope:"undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync?wx:"undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync?swan:void 0,platformAppInstance:void 0,platformGlobal:function(){return i.MPEnv.platformAppInstance?i.MPEnv.platformAppInstance:"function"==typeof getApp?getApp():"undefined"!=typeof window?window:void 0!==e?e:n},platformPC:function(){return!1},platformWindow:function(e){return e&&e.window?e.window:"undefined"!=typeof window?window:void 0}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPEnv=i.ComponentFactory=i.setDOMStyle=i.setDOMAttribute=i.PluginRegister=i.MPEventChannel=i.MPMethodChannel=i.MPPlatformView=i.BrowserApp=i.Page=i.Engine=void 0;var n=e("./engine");Object.defineProperty(i,"Engine",{enumerable:!0,get:function(){return n.Engine}});var o=e("./page");Object.defineProperty(i,"Page",{enumerable:!0,get:function(){return o.Page}});var r=e("./browser_app");Object.defineProperty(i,"BrowserApp",{enumerable:!0,get:function(){return r.BrowserApp}});var s=e("./components/mpkit/platform_view");Object.defineProperty(i,"MPPlatformView",{enumerable:!0,get:function(){return s.MPPlatformView}});var a=e("./platform_channel/mp_method_channel");Object.defineProperty(i,"MPMethodChannel",{enumerable:!0,get:function(){return a.MPMethodChannel}});var l=e("./platform_channel/mp_event_channel");Object.defineProperty(i,"MPEventChannel",{enumerable:!0,get:function(){return l.MPEventChannel}});var c=e("./platform_channel/plugin_register");Object.defineProperty(i,"PluginRegister",{enumerable:!0,get:function(){return c.PluginRegister}});var u=e("./components/dom_utils");Object.defineProperty(i,"setDOMAttribute",{enumerable:!0,get:function(){return u.setDOMAttribute}}),Object.defineProperty(i,"setDOMStyle",{enumerable:!0,get:function(){return u.setDOMStyle}});var d=e("./components/component_factory");Object.defineProperty(i,"ComponentFactory",{enumerable:!0,get:function(){return d.ComponentFactory}});var h=e("./env");Object.defineProperty(i,"MPEnv",{enumerable:!0,get:function(){return h.MPEnv}})},{"./browser_app":1,"./components/component_factory":26,"./components/dom_utils":29,"./components/mpkit/platform_view":36,"./engine":44,"./env":45,"./page":49,"./platform_channel/mp_event_channel":50,"./platform_channel/mp_method_channel":51,"./platform_channel/plugin_register":53}],47:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPEnv=i.ComponentFactory=i.setDOMStyle=i.setDOMAttribute=i.PluginRegister=i.MPEventChannel=i.MPMethodChannel=i.MPPlatformView=i.WXPage=i.WXApp=i.Page=i.Engine=void 0;var n=e("./engine");Object.defineProperty(i,"Engine",{enumerable:!0,get:function(){return n.Engine}});var o=e("./page");Object.defineProperty(i,"Page",{enumerable:!0,get:function(){return o.Page}});var r=e("./wx_app");Object.defineProperty(i,"WXApp",{enumerable:!0,get:function(){return r.WXApp}}),Object.defineProperty(i,"WXPage",{enumerable:!0,get:function(){return r.WXPage}});var s=e("./components/mpkit/platform_view");Object.defineProperty(i,"MPPlatformView",{enumerable:!0,get:function(){return s.MPPlatformView}});var a=e("./platform_channel/mp_method_channel");Object.defineProperty(i,"MPMethodChannel",{enumerable:!0,get:function(){return a.MPMethodChannel}});var l=e("./platform_channel/mp_event_channel");Object.defineProperty(i,"MPEventChannel",{enumerable:!0,get:function(){return l.MPEventChannel}});var c=e("./platform_channel/plugin_register");Object.defineProperty(i,"PluginRegister",{enumerable:!0,get:function(){return c.PluginRegister}});var u=e("./components/dom_utils");Object.defineProperty(i,"setDOMAttribute",{enumerable:!0,get:function(){return u.setDOMAttribute}}),Object.defineProperty(i,"setDOMStyle",{enumerable:!0,get:function(){return u.setDOMStyle}});var d=e("./components/component_factory");Object.defineProperty(i,"ComponentFactory",{enumerable:!0,get:function(){return d.ComponentFactory}});var h=e("./env");Object.defineProperty(i,"MPEnv",{enumerable:!0,get:function(){return h.MPEnv}})},{"./components/component_factory":26,"./components/dom_utils":29,"./components/mpkit/platform_view":36,"./engine":44,"./env":45,"./page":49,"./platform_channel/mp_event_channel":50,"./platform_channel/mp_method_channel":51,"./platform_channel/plugin_register":53,"./wx_app":57}],48:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPJS=void 0;var n=e("../env"),o=function(){function e(e){this.engine=e,this.engineScope={},this.objectRefs={}}return e.prototype.handleMessage=function(e,t,i){"callMethod"===e.event?this.callMethod(e,t,i):"getValue"===e.event?this.getValue(e,t):"setValue"===e.event?this.setValue(e,t):"hasProperty"===e.event?this.hasProperty(e,t):"deleteProperty"===e.event&&this.deleteProperty(e,t)},e.prototype.callMethod=function(e,t,i){var n;return __awaiter(this,void 0,void 0,(function(){var o,r,s,a,l=this;return __generator(this,(function(c){switch(c.label){case 0:if(o=e.params,"object"!=typeof(r=this.getCallee(o.objectHandler,o.callChain))&&"function"!=typeof r)return[3,5];c.label=1;case 1:return c.trys.push([1,4,,5]),(s=r[o.method].apply(r,null===(n=o.args)||void 0===n?void 0:n.map((function(e){return l.wrapArgument(e,i)}))))instanceof Promise?[4,s]:[3,3];case 2:s=c.sent(),c.label=3;case 3:return t(this.wrapResult(s)),[3,5];case 4:return a=c.sent(),console.error(a),[3,5];case 5:return[2]}}))}))},e.prototype.getValue=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i,n,o;return __generator(this,(function(r){switch(r.label){case 0:return i=e.params,n=this.getCallee(i.objectHandler,i.callChain),(o=n[i.key])instanceof Promise?[4,o]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return t(this.wrapResult(o)),[2]}}))}))},e.prototype.setValue=function(e,t){var i=e.params;this.getCallee(i.objectHandler,i.callChain)[i.key]=i.value,t(void 0)},e.prototype.hasProperty=function(e,t){var i=e.params,n=this.getCallee(i.objectHandler,i.callChain);t(this.wrapResult(n&&n.hasOwnProperty(i.key)))},e.prototype.deleteProperty=function(e,t){var i=e.params,n=this.getCallee(i.objectHandler,i.callChain);n&&delete n[i.key],t(1)},e.prototype.getCallee=function(e,t){var i,o,r,s,a=null!==(i=this.objectRefs[e])&&void 0!==i?i:n.MPEnv.platformGlobal();"engineScope"===t[0]&&(a=this.engineScope,t.shift());for(var l=0;l<t.length;l++){var c=t[l];if(a=a[c],"document"===c&&0===l&&void 0===a&&(a=null===(s=null===(r=null===(o=this.engine)||void 0===o?void 0:o.managedViews)||void 0===r?void 0:r[0])||void 0===s?void 0:s.document),null==a)break}return a},e.prototype.wrapArgument=function(e,t){var i=this;if("string"==typeof e&&0===e.indexOf("func:")){var n=e,o=this;return function(){for(var e=[],i=0;i<arguments.length;i++){var r=arguments[i];e.push(o.wrapResult(r))}t(n,e)}}if("string"==typeof e&&0===e.indexOf("obj:"))return this.objectRefs[e.replace("obj:","")];if("object"==typeof e&&e instanceof Array)return e.map((function(e){return i.wrapArgument(e,t)}));if("object"==typeof e){var r={};for(var s in e)r[s]=this.wrapArgument(e[s],t);return r}return e},e.prototype.wrapResult=function(e){var t=this;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e||"bigint"==typeof e)return e;if("object"==typeof e&&e instanceof Array)return e.map((function(e){return t.wrapResult(e)}));var i=Math.random().toString();return this.objectRefs[i]=e,{objectHandler:i}},e}();i.MPJS=o},{"../env":45}],49:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Page=void 0;var n=e("./components/dom_utils"),o=e("./components/mpkit/scaffold"),r=e("./env"),s=e("./router"),a=function(){function e(e,t,i,n){var o=this;void 0===n&&(n=null===self||void 0===self?void 0:self.document),this.element=e,this.engine=t,this.options=i,this.document=n,this._active=!0,this.viewId=-1,this.overlaysView=[],this.isFirst=!1,this.bodyElement=n.createElement("wx-view"),this.overlayElement=n.createElement("wx-view"),this.bodyElement===e&&this.overlayElement===e||(this.element.appendChild(this.bodyElement),this.element.appendChild(this.overlayElement)),this.requestRoute().then((function(e){var i;o.viewId=e,t.managedViews[o.viewId]=o,t.pageMode=!0,t.unmanagedViewFrameData[o.viewId]&&(t.unmanagedViewFrameData[o.viewId].forEach((function(e){o.didReceivedFrameData(e)})),delete t.unmanagedViewFrameData[o.viewId]),null===(i=o.readyCallback)||void 0===i||i.call(o,void 0)}))}return e.prototype.ready=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){e.readyCallback=t}))]}))}))},e.prototype.requestRoute=function(){var e,t,i,n,o,r;return __awaiter(this,void 0,void 0,(function(){var a,l;return __generator(this,(function(c){switch(c.label){case 0:return this.engine.app||(this.engine.router=new s.Router(this.engine)),a=null!==(t=null===(e=this.engine.app)||void 0===e?void 0:e.router)&&void 0!==t?t:null===(i=this.engine)||void 0===i?void 0:i.router,[4,this.fetchViewport()];case 1:return l=c.sent(),[2,a.requestRoute(null!==(o=null===(n=this.options)||void 0===n?void 0:n.route)&&void 0!==o?o:"/",null===(r=this.options)||void 0===r?void 0:r.params,this.isFirst||void 0===this.engine.app,{width:l.width,height:l.height})]}}))}))},e.prototype.fetchViewport=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(i){switch(i.label){case 0:return t=[{}],[4,this.element.getBoundingClientRect()];case 1:return(!(e=__assign.apply(void 0,t.concat([i.sent()]))).width||e.width<=.1)&&(e.width=r.MPEnv.platformScope.getSystemInfoSync().windowWidth),(!e.height||e.height<=.1)&&(e.height=r.MPEnv.platformScope.getSystemInfoSync().windowHeight),[2,e]}}))}))},e.prototype.dispose=function(){delete this.engine.managedViews[this.viewId]},e.prototype.viewportChanged=function(){var e,t,i;return __awaiter(this,void 0,void 0,(function(){var n,o;return __generator(this,(function(r){switch(r.label){case 0:return(n=null!==(t=null===(e=this.engine.app)||void 0===e?void 0:e.router)&&void 0!==t?t:null===(i=this.engine)||void 0===i?void 0:i.router)?[4,this.fetchViewport()]:[3,2];case 1:o=r.sent(),n.updateRoute(this.viewId,{width:o.width,height:o.height}),r.label=2;case 2:return[2]}}))}))},e.prototype.didReceivedFrameData=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return(!e.overlays||e.overlays&&e.overlays instanceof Array&&0===e.overlays.length)&&this.overlaysView.length>0?(this.overlaysView.forEach((function(e){e.htmlElement.style.visibility="hidden"})),[4,this.removeOverlays()]):[3,2];case 1:i.sent(),i.label=2;case 2:if(!0!==e.ignoreScaffold){if(!((t=this.engine.componentFactory.create(e.scaffold,this.document))instanceof o.MPScaffold))return[2];this.scaffoldView!==t&&(this.scaffoldView&&(this.scaffoldView.htmlElement.remove(),this.scaffoldView.removeFromSuperview()),this.scaffoldView=t,t instanceof o.MPScaffold&&!t.delegate&&(t.setDelegate(new l(this.document,this.miniProgramPage)),t.setAttributes(e.scaffold.attributes))),this.scaffoldView&&this.active&&!this.scaffoldView.attached&&(this.scaffoldView.attached=!0,this.bodyElement.appendChild(this.scaffoldView.htmlElement),(0,n.setDOMStyle)(this.scaffoldView.htmlElement,{display:"contents"}))}return e.overlays&&e.overlays instanceof Array&&this.setOverlays(e.overlays),[2]}}))}))},e.prototype.onRefresh=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scaffoldView instanceof o.MPScaffold?[4,this.scaffoldView.onRefresh()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.onWechatMiniProgramShareAppMessage=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scaffoldView instanceof o.MPScaffold?[4,this.scaffoldView.onWechatMiniProgramShareAppMessage()]:[3,2];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.onReachBottom=function(){this.scaffoldView instanceof o.MPScaffold&&this.scaffoldView.onReachBottom()},e.prototype.onPageScroll=function(e){this.scaffoldView instanceof o.MPScaffold&&this.scaffoldView.onPageScroll(e)},e.prototype.removeOverlays=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){e.overlaysView.forEach((function(e){e.removeFromSuperview(),setTimeout((function(){e.htmlElement.remove()}),300)})),e.overlaysView=[],setTimeout((function(){t(null)}),100)}))]}))}))},e.prototype.setOverlays=function(e){var t=this,i=e.map((function(e){return t.engine.componentFactory.create(e,t.document)})).filter((function(e){return e}));i.length===this.overlaysView.length&&i.every((function(e,n){return i[n]===t.overlaysView[n]}))||(this.overlaysView.forEach((function(e){e.removeFromSuperview(),setTimeout((function(){e.htmlElement.remove()}),300)})),i.forEach((function(e){t.overlayElement.appendChild(e.htmlElement)})),this.overlaysView=i)},Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(e){var t;this._active=e,e?(null===(t=this.scaffoldView)||void 0===t?void 0:t.htmlElement)&&(this.element.appendChild(this.scaffoldView.htmlElement),this.scaffoldView.setAttributes(this.scaffoldView.attributes)):this.scaffoldView&&(this.scaffoldView.attached=!1,this.scaffoldView.htmlElement.remove())},enumerable:!1,configurable:!0}),e}();i.Page=a;!function(){function e(e,t){this.document=e,this.scaffoldView=t,this.observingScroller=!1,this.installPageScrollListener()}e.prototype.setPageTitle=function(e){this.document.title=e},e.prototype.setPageBackgroundColor=function(e){this.document.body.style.backgroundColor=e},e.prototype.setAppBarColor=function(e,t){},e.prototype.installPageScrollListener=function(){var e,t=this;e=function(i){if(!t.scaffoldView.htmlElement.isConnected)return t.observingScroller=!1,void window.removeEventListener("scroll",e);t.scaffoldView.onPageScroll(window.scrollY)},this.observingScroller||(this.observingScroller=!0,window.addEventListener("scroll",e))}}();var l=function(){function e(e,t){this.document=e,this.miniProgramPage=t,this.backgroundElement=this.document.createElement("div"),this.backgroundElementAttached=!1}return e.prototype.setPageTitle=function(e){r.MPEnv.platformScope.setNavigationBarTitle({title:e})},e.prototype.setPageBackgroundColor=function(e){if("transparent"===e)return this.backgroundElement.remove(),void(this.backgroundElementAttached=!1);(0,n.setDOMStyle)(this.backgroundElement,{position:"fixed",width:"100vw",height:"100vh",zIndex:"-1",backgroundColor:e}),this.backgroundElementAttached||(this.document.body.appendChild(this.backgroundElement),this.backgroundElementAttached=!0)},e.prototype.setAppBarColor=function(e,t){r.MPEnv.platformScope.setNavigationBarColor({frontColor:t,backgroundColor:e})},e}()},{"./components/dom_utils":29,"./components/mpkit/scaffold":37,"./env":45,"./router":54}],50:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPEventChannel=void 0;var n=function(){function e(){}return e.prototype.onListen=function(e,t){},e.prototype.onCancel=function(e){},e}();i.MPEventChannel=n},{}],51:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MPMethodChannel=void 0;var n=0;var o=function(){function e(){}return e.prototype.onMethodCall=function(e,t){throw"NOTIMPLEMENTED"},e.prototype.invokeMethod=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){if(i.channelName&&i.engine){var s=++n;i.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"invokeMethod",method:i.channelName,beInvokeMethod:e,beInvokeParams:t,seqId:s}})),i.engine.platformChannelIO.responseCallbacks[s]=[o,r]}}))]}))}))},e}();i.MPMethodChannel=o},{}],52:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.PlatformChannelIO=void 0;var n=e(".."),o=e("./plugin_register"),r=function(){function e(e){for(var t in this.engine=e,this.pluginInstances={},this.responseCallbacks={},o.PluginRegister.registedChannels)if(Object.prototype.hasOwnProperty.call(o.PluginRegister.registedChannels,t)){var i=o.PluginRegister.registedChannels[t];try{this.pluginInstances[t]=new i,this.pluginInstances[t].channelName=t,this.pluginInstances[t].engine=e}catch(e){console.error(e)}}}return e.prototype.didReceivedPlatformChannel=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,o,r,s,a,l,c,u,d=this;return __generator(this,(function(h){switch(h.label){case 0:if("invokeMethod"!==e.event)return[3,7];if(t=e.method,i=e.beInvokeMethod,o=e.beInvokeParams,r=e.seqId,!((s=this.pluginInstances[t])instanceof n.MPMethodChannel))return[3,5];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,s.onMethodCall(i,o)];case 2:return c=h.sent(),this.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackResult",result:c,seqId:r}})),[3,4];case 3:return a=h.sent(),this.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackResult",result:"ERROR:"+a,seqId:r}})),[3,4];case 4:return[3,6];case 5:s instanceof n.MPEventChannel&&("listen"===i?s.onListen(o,(function(e){d.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackEventSink",method:t,result:e,seqId:r}}))})):"cancel"===i&&s.onCancel(o)),h.label=6;case 6:return[3,8];case 7:"callbackResult"===e.event&&(l=e.seqId,c=e.result,void 0!==(u=this.responseCallbacks[l])&&("NOTIMPLEMENTED"===c||"string"==typeof c&&0===c.indexOf("ERROR:")?u[1](c):u[0](c)),delete this.responseCallbacks[l]),h.label=8;case 8:return[2]}}))}))},e}();i.PlatformChannelIO=r},{"..":46,"./plugin_register":53}],53:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.PluginRegister=void 0;var n=e("../components/component_factory"),o=function(){function e(){}return e.registerChannel=function(e,t){this.registedChannels[e]=t},e.registerPlatformView=function(e,t){n.ComponentFactory.components[e]=t},e.registedChannels={},e}();i.PluginRegister=o},{"../components/component_factory":26}],54:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Router=void 0;var n=function(){function e(e){this.engine=e,this.routeResponseHandler={}}return e.clearBeingPushTimeout=function(){this.beingPushTimeout&&(clearTimeout(this.beingPushTimeout),this.beingPushTimeout=void 0)},e.prototype.updateRoute=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){return this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:e,viewport:t}})),[2]}))}))},e.prototype.requestRoute=function(e,t,i,n){return __awaiter(this,void 0,void 0,(function(){var o,r,s=this;return __generator(this,(function(a){return this.thePushingRouteId?(o=this.thePushingRouteId,this.thePushingRouteId=void 0,this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:o,viewport:n}})),[2,o]):(r=Math.random().toString(),[2,new Promise((function(o){s.routeResponseHandler[r]=o,s.engine.sendMessage(JSON.stringify({type:"router",message:{event:"requestRoute",requestId:r,name:e,params:null!=t?t:{},viewport:n,root:!0===i}}))}))])}))}))},e.prototype.responseRoute=function(e){var t,i=e.requestId,n=e.routeId;null===(t=this.routeResponseHandler[i])||void 0===t||t.call(this,n)},e.prototype.disposeRoute=function(e){this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"disposeRoute",routeId:e}}))},e.prototype.didReceivedRouteData=function(e){var t=e.event;"responseRoute"===t?this.responseRoute(e):"didPush"===t?this.didPush(e):"didReplace"===t?this.didReplace(e):"didPop"===t&&this.didPop()},e.prototype.didPush=function(e){throw"native implementation"},e.prototype.didReplace=function(e){throw"native implementation"},e.prototype.didPop=function(){throw"native implementation"},e.beingPush=!1,e}();i.Router=n},{}],55:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TextMeasurer=void 0;var n=e("./components/component_factory"),o=e("./components/dom_utils"),r=e("./router"),s=function(){function e(){}return e.delay=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,new Promise((function(e){setTimeout((function(){e(null)}),50)}))]}))}))},e.calcMeasureCache=function(e){var t=e.textCache,i=e.textCacheSize,n=this.zhMeasureCache[i]?{measureId:e.attributes.measureId,width:Math.ceil(this.zhMeasureCache[i].width*t.length)+1,height:Math.ceil(this.zhMeasureCache[i].height)+1}:void 0;if(e.constraints&&n&&(n.width<e.constraints.w||0===e.constraints.w))return n},e.saveMeasureCache=function(e,t){var i=e.textCache,n=e.textCacheSize;if(e.constraints&&(e.constraints.w>t.width+44||0===e.constraints.w)){var o={width:t.width/i.length,height:t.height};this.zhMeasureCache[n]=o}},e.didReceivedDoMeasureData=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i,s,a,l=this;return __generator(this,(function(c){switch(c.label){case 0:this.activeTextMeasureDocument||(this.activeTextMeasureDocument=document),c.label=1;case 1:return r.Router.beingPush?[4,this.delay()]:[3,3];case 2:return c.sent(),[3,1];case 3:return t.items?(n.ComponentFactory.disableCache=!0,i=t.items,s=i.map((function(t){return e.componentFactory.create(t,l.activeTextMeasureDocument)})).filter((function(e){return e})),n.ComponentFactory.disableCache=!1,a=s.length<5,[4,Promise.all(s.map((function(e){return __awaiter(l,void 0,void 0,(function(){var t,i,n,r,s,l,c,u,d,h;return __generator(this,(function(p){switch(p.label){case 0:return e.canMeasureResultCache&&(t=this.calcMeasureCache(e))?[2,t]:((0,o.setDOMStyle)(e.htmlElement,{position:"fixed",top:"0px",left:"0px",opacity:"0",width:"unset",maxWidth:(null===(n=e.attributes)||void 0===n?void 0:n.maxWidth)&&"Infinity"!==(null===(r=e.attributes)||void 0===r?void 0:r.maxWidth)?(null===(s=e.attributes)||void 0===s?void 0:s.maxWidth)+"px":"999999px",height:"unset",maxHeight:(null===(l=e.attributes)||void 0===l?void 0:l.maxHeight)&&"Infinity"!==(null===(c=e.attributes)||void 0===c?void 0:c.maxHeight)?(null===(u=e.attributes)||void 0===u?void 0:u.maxHeight)+"px":"999999px"}),this.activeTextMeasureDocument.body.appendChild(e.htmlElement),a?[3,2]:[4,this.delay()]);case 1:p.sent(),p.label=2;case 2:return[4,e.htmlElement.getBoundingClientRect()];case 3:return i=p.sent(),e.htmlElement.remove(),e.canMeasureResultCache&&this.saveMeasureCache(e,i),[2,{measureId:e.attributes.measureId,width:Math.ceil(null!==(d=null==i?void 0:i.width)&&void 0!==d?d:0)+1,height:Math.ceil(null!==(h=null==i?void 0:i.height)&&void 0!==h?h:0)+1}]}}))}))})))]):[3,5];case 4:c.sent().forEach((function(t){e.componentFactory.callbackTextMeasureResult(t.measureId,t)})),c.label=5;case 5:return[2]}}))}))},e.zhMeasureCache={},e}();i.TextMeasurer=s},{"./components/component_factory":26,"./components/dom_utils":29,"./router":54}],56:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WindowInfo=void 0;var n=e("./env"),o=function(){function e(e){this.engine=e}return e.prototype.updateWindowInfo=function(){var e;this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:n.MPEnv.platformScope.getSystemInfoSync().screenWidth,height:n.MPEnv.platformScope.getSystemInfoSync().screenHeight,padding:{top:n.MPEnv.platformScope.getSystemInfoSync().statusBarHeight,bottom:n.MPEnv.platformScope.getSystemInfoSync().screenHeight-(null===(e=n.MPEnv.platformScope.getSystemInfoSync().safeArea)||void 0===e?void 0:e.bottom)}},devicePixelRatio:n.MPEnv.platformScope.getSystemInfoSync().pixelRatio}}))},e}();i.WindowInfo=o},{"./env":45}],57:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WXPage=i.WXApp=void 0;var n=e("./platform_channel/plugin_register"),o=e("./platform_channel/mp_method_channel"),r=e("./env"),s=e("./page"),a=e("./router"),l=e("./text_measurer"),c={};try{var u=e("mp-custom-components");u.usingComponents&&(c=u.usingComponents)}catch(e){console.error(e)}var d={router:{},runtime:{subpackagesMap:{},tabBarMap:{},usingComponents:c},pages:{index:{}},redirect:{},optimization:{domSubTreeLevel:10,elementMultiplexing:!0,textMultiplexing:!0,commentMultiplexing:!0,domExtendMultiplexing:!0,styleValueReduce:5e3,attrValueReduce:5e3}},h=function(e,t){this.indexPage=e,this.engine=t,this.router=new p(this.engine),t.app=this};i.WXApp=h;i.WXPage=function(e,t,i){return void 0===t&&(t="#vdom"),void 0===i&&(i=r.MPEnv.platformGlobal().app),{data:{pageMeta:{naviBar:{}}},kboneRender:void 0,kboneDocument:void 0,kbonePageId:void 0,prepare:function(){var e=this,t=this.kboneRender.createPage(this.route,d);this.kbonePageId=t.pageId;var i=t.window;this.kboneDocument=t.document,this.kboneDocument.window=i,i.$$createSelectorQuery=function(){return r.MPEnv.platformScope.createSelectorQuery().in(e)},i.$$createIntersectionObserver=function(t){return r.MPEnv.platformScope.createIntersectionObserver(e,t)},this.setData({pageId:this.kbonePageId})},onLoad:function(t){this.prepare();var n=this.kboneDocument,o=this.kboneDocument;l.TextMeasurer.activeTextMeasureDocument=o,a.Router.clearBeingPushTimeout(),a.Router.beingPush=!1;var r,c=((r=i.indexPage.split("/")).pop(),r.join("/")),u=e;if(!e||t.route){var d=__assign({},t);delete d.route,t.route?u={route:t.route,params:d}:"/index"===(u={route:this.route.replace(c,""),params:d}).route&&(u.route="/")}(null==u?void 0:u.route)&&(u.route=decodeURIComponent(u.route),u.params=__assign({},t)),this.mpPage=new s.Page(n.body,i.engine,u,n),this.mpPage.miniProgramPage=this,this.mpPage.isFirst=1===getCurrentPages().length},onUnload:function(){this.mpPage.viewId&&i.router.disposeRoute(this.mpPage.viewId)},onShow:function(){var e;l.TextMeasurer.activeTextMeasureDocument=null!==(e=this.kboneDocument)&&void 0!==e?e:this.selectComponent(t+"_tm").miniDom.document,a.Router.clearBeingPushTimeout(),a.Router.beingPush=!1},onPullDownRefresh:function(){this.mpPage.onRefresh().then((function(e){r.MPEnv.platformScope.stopPullDownRefresh()}))},onShareAppMessage:function(){return{promise:this.mpPage.onWechatMiniProgramShareAppMessage()}},onReachBottom:function(){this.mpPage.onReachBottom()},onPageScroll:function(e){this.mpPage.onPageScroll(e.scrollTop),this.kboneDocument.window.scrollY=e.scrollTop,this.kboneDocument.window.scrollY=e.scrollTop,this.kboneDocument.window.scrollY=e.scrollTop,this.kboneDocument.window.$$trigger("scroll",e.scrollTop)}}};var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.encodeRelativePath=function(e,t){var i=[];if(t)for(var n in t)i.push(n+"="+encodeURIComponent(t[n]));return i.length>0?e+"?"+i.join("&"):""+e},t.prototype.encodeIndexPath=function(e,t){var i=[];if(t)for(var n in t)i.push(n+"="+encodeURIComponent(t[n]));var o=e.indexOf("?")>=0?e.split("?")[0]:e,r=e.indexOf("?")>=0?e.substr(e.indexOf("?")):"";return i.length>0?"/"+this.engine.app.indexPage+"?route="+encodeURI(o)+encodeURIComponent(r)+"&"+i.join("&"):"/"+this.engine.app.indexPage+"?route="+encodeURI(o)+encodeURIComponent(r)},t.prototype.didPush=function(e){var t=this;a.Router.clearBeingPushTimeout(),a.Router.beingPush=!0;var i=e.routeId;this.thePushingRouteId=i;var n=e.name;r.MPEnv.platformScope.navigateTo({url:this.encodeRelativePath(n,e.params),fail:function(){r.MPEnv.platformScope.navigateTo({url:t.encodeIndexPath(n,e.params)})}}),a.Router.beingPushTimeout=setTimeout((function(){a.Router.beingPush=!1}),1e3)},t.prototype.didReplace=function(e){var t=this;a.Router.clearBeingPushTimeout(),a.Router.beingPush=!0;var i=e.routeId;this.thePushingRouteId=i;var n=e.name;r.MPEnv.platformScope.redirectTo({url:this.encodeRelativePath(n,e.params),fail:function(){r.MPEnv.platformScope.redirectTo({url:t.encodeIndexPath(n,e.params)})}}),a.Router.beingPushTimeout=setTimeout((function(){a.Router.beingPush=!1}),1e3)},t.prototype.didPop=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return a.Router.beingPush?[4,this.delayPop()]:[3,2];case 1:e.sent(),e.label=2;case 2:return a.Router.clearBeingPushTimeout(),a.Router.beingPush=!0,r.MPEnv.platformScope.navigateBack(),a.Router.beingPushTimeout=setTimeout((function(){a.Router.beingPush=!1}),1e3),[2]}}))}))},t.prototype.delayPop=function(){0},t}(a.Router),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onMethodCall=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){if("Clipboard.setData"===e)return r.MPEnv.platformScope.setClipboardData({data:t.text}),[2,null];if("Clipboard.getData"===e)return[2,new Promise((function(e,t){r.MPEnv.platformScope.getClipboardData({success:function(t){e({text:t.data})},fail:function(e){t(e)}})}))];throw"NOTIMPLEMENTED"}))}))},t}(o.MPMethodChannel);n.PluginRegister.registerChannel("flutter/platform",f)},{"./env":45,"./page":49,"./platform_channel/mp_method_channel":51,"./platform_channel/plugin_register":53,"./router":54,"./text_measurer":55,"mp-custom-components":"mp-custom-components"}]},{},[47])(47)}));
